<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<script src="disk.frame-report_files/htmlwidgets.txt"></script>
<script src="disk.frame-report_files/jquery_002.txt"></script>
<link href="disk.frame-report_files/datatables-crosstalk.css" rel="stylesheet">
<script src="disk.frame-report_files/datatables.txt"></script>
<link href="disk.frame-report_files/jquery_002.css" rel="stylesheet">
<link href="disk.frame-report_files/jquery.css" rel="stylesheet">
<script src="disk.frame-report_files/jquery.txt"></script>
<link href="disk.frame-report_files/crosstalk.css" rel="stylesheet">
<script src="disk.frame-report_files/crosstalk.txt"></script>
<link href="disk.frame-report_files/rstudio.css" rel="stylesheet">
<script src="disk.frame-report_files/highlight.txt"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="disk.frame-report_files/bootstrap.css" rel="stylesheet">
<link href="disk.frame-report_files/bootstrap-theme.css" rel="stylesheet">
<script src="disk.frame-report_files/bootstrap.txt"></script>
<script src="disk.frame-report_files/html5shiv.txt"></script>
<script src="disk.frame-report_files/respond.txt"></script>

</head>
<body style="background-color:white;">
<div class="container-fluid">
  <style type="text/css">table tr:hover td {

  font-weight:bold;text-decoration:none

}

table tr.covered td{

  background-color:rgba(95,151,68,0.3)

}



table tr:hover.covered .num{

  background-color:rgba(95,151,68,0.7)

}

table tr.missed td{

  background-color:rgba(185,73,71,0.3)

}

table tr:hover.missed .num{

  background-color:rgba(185,73,71,0.7)

}



table tr.missed:hover td{

  -webkit-box-shadow:0 -2px 0 0 #b94947 inset;

  -moz-box-shadow:0 -2px 0 0 #b94947 inset;

  box-shadow:0 -2px 0 0 #b94947 inset

}

table tr.covered:hover td{

  -webkit-box-shadow:0 -2px 0 0 #5f9744 inset;

  -moz-box-shadow:0 -2px 0 0 #5f9744 inset;

  box-shadow:0 -2px 0 0 #5f9744 inset

}



table tr.never td{

  background-color:transparent

}



table tbody {

  border-style: solid;

  border: 1px solid rgba(0,0,0,0.1)

}



table .num {

  border-right: 1px solid rgba(0,0,0,0.1)

}



td.coverage em {

  opacity: 0.5;

}



table td.coverage {

  border-right: 1px solid rgba(0,0,0,0.1);

  font-weight: bold;

  text-align: center;

}

table.table-condensed pre {

  background-color: transparent;

  margin: 0;

  padding: 0;

  border: 0;

  font-size: 11px;

}

div#files td {

  padding: 0;

  padding-left: 5px;

}



div#files td.num {

  padding-right: 5px;

}



table.table-condensed {

  font-size: 11px;

}</style>
  <div class="col-md-8 col-md-offset-2">
    <h2>disk.frame coverage - 56.34%</h2>
    <div class="tabbable">
      <ul class="nav nav-tabs" data-tabsetid="covr">
        <li class="active">
          <a href="#tab-covr-1" data-toggle="tab" data-value="Files">Files</a>
        </li>
        <li>
          <a href="#tab-covr-2" data-toggle="tab" data-value="Source">Source</a>
        </li>
      </ul>
      <div class="tab-content" data-tabsetid="covr">
        <div class="tab-pane active" title="Files" data-value="Files" id="tab-covr-1">
          <div id="htmlwidget-0338641141ef97f304a6" style="width:100%;height:500px;" class="datatables html-widget html-widget-static-bound"><div id="DataTables_Table_0_wrapper" class="dataTables_wrapper no-footer"><div class="dataTables_scroll"><div class="dataTables_scrollHead" style="overflow: hidden; position: relative; border: 0px none; width: 100%;"><div class="dataTables_scrollHeadInner" style="box-sizing: content-box; width: 786px; padding-right: 17px;"><table class="row-border fill-container dataTable no-footer" role="grid" style="margin-left: 0px; width: 786px;"><thead>
    <tr role="row"><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 156px;" aria-label="File: activate to sort column ascending">File</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 43px;" aria-label="Lines: activate to sort column ascending">Lines</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 67px;" aria-label="Relevant: activate to sort column ascending">Relevant</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 64px;" aria-label="Covered: activate to sort column ascending">Covered</th><th class="dt-right sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 55px;" aria-label="Missed: activate to sort column ascending">Missed</th><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 76px;" aria-label="Hits / Line: activate to sort column ascending">Hits / Line</th><th class="sorting" tabindex="0" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="width: 73px;" aria-label="Coverage: activate to sort column ascending">Coverage</th></tr>
  </thead></table></div></div><div class="dataTables_scrollBody" style="position: relative; overflow: auto; width: 100%; height: 459px;"><table class="row-border fill-container dataTable no-footer" id="DataTables_Table_0" role="grid"><thead>
    <tr role="row" style="height: 0px;"><th class="sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 156px;" aria-label="File: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">File</div></th><th class="dt-right sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 43px;" aria-label="Lines: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Lines</div></th><th class="dt-right sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 67px;" aria-label="Relevant: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Relevant</div></th><th class="dt-right sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 64px;" aria-label="Covered: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Covered</div></th><th class="dt-right sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 55px;" aria-label="Missed: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Missed</div></th><th class="sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 76px;" aria-label="Hits / Line: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Hits / Line</div></th><th class="sorting" aria-controls="DataTables_Table_0" rowspan="1" colspan="1" style="padding-top: 0px; padding-bottom: 0px; border-top-width: 0px; border-bottom-width: 0px; height: 0px; width: 73px;" aria-label="Coverage: activate to sort column ascending"><div class="dataTables_sizing" style="height:0;overflow:hidden;">Coverage</div></th></tr>
  </thead>
  
<tbody><tr role="row" class="odd"><td><a href="#">R/zip_to_disk.frame.r</a></td><td class=" dt-right">114</td><td class=" dt-right">45</td><td class=" dt-right">0</td><td class=" dt-right">45</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="even"><td><a href="#">R/sas2disk_frame.r</a></td><td class=" dt-right">75</td><td class=" dt-right">40</td><td class=" dt-right">0</td><td class=" dt-right">40</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/foverlaps.disk.frame.r</a></td><td class=" dt-right">101</td><td class=" dt-right">36</td><td class=" dt-right">0</td><td class=" dt-right">36</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="even"><td><a href="#">R/move_to.r</a></td><td class=" dt-right">66</td><td class=" dt-right">22</td><td class=" dt-right">0</td><td class=" dt-right">22</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/csv2disk.frame_readr.r</a></td><td class=" dt-right">39</td><td class=" dt-right">7</td><td class=" dt-right">0</td><td class=" dt-right">7</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="even"><td><a href="#">R/print.disk.frame.r</a></td><td class=" dt-right">16</td><td class=" dt-right">6</td><td class=" dt-right">0</td><td class=" dt-right">6</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 0%, white 0%) repeat scroll 0% 0%;">0.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/csv2disk.frame.r</a></td><td class=" dt-right">197</td><td class=" dt-right">115</td><td class=" dt-right">12</td><td class=" dt-right">103</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 10.43%, white 10.43%) repeat scroll 0% 0%;">10.43%</td></tr><tr role="row" class="even"><td><a href="#">R/setup.r</a></td><td class=" dt-right">86</td><td class=" dt-right">22</td><td class=" dt-right">3</td><td class=" dt-right">19</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 13.64%, white 13.64%) repeat scroll 0% 0%;">13.64%</td></tr><tr role="row" class="odd"><td><a href="#">R/sample_n.R</a></td><td class=" dt-right">9</td><td class=" dt-right">3</td><td class=" dt-right">1</td><td class=" dt-right">2</td><td>0</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 33.33%, white 33.33%) repeat scroll 0% 0%;">33.33%</td></tr><tr role="row" class="even"><td><a href="#">R/disk.frame.r</a></td><td class=" dt-right">236</td><td class=" dt-right">96</td><td class=" dt-right">33</td><td class=" dt-right">63</td><td>139</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 34.38%, white 34.38%) repeat scroll 0% 0%;">34.38%</td></tr><tr role="row" class="odd"><td><a href="#">R/collect.r</a></td><td class=" dt-right">75</td><td class=" dt-right">16</td><td class=" dt-right">6</td><td class=" dt-right">10</td><td>16</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 37.5%, white 37.5%) repeat scroll 0% 0%;">37.50%</td></tr><tr role="row" class="even"><td><a href="#">R/hard_group_by.r</a></td><td class=" dt-right">178</td><td class=" dt-right">65</td><td class=" dt-right">29</td><td class=" dt-right">36</td><td>19</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 44.62%, white 44.62%) repeat scroll 0% 0%;">44.62%</td></tr><tr role="row" class="odd"><td><a href="#">R/remove_chunk.r</a></td><td class=" dt-right">44</td><td class=" dt-right">11</td><td class=" dt-right">7</td><td class=" dt-right">4</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 63.64%, white 63.64%) repeat scroll 0% 0%;">63.64%</td></tr><tr role="row" class="even"><td><a href="#">R/sample_frac.R</a></td><td class=" dt-right">25</td><td class=" dt-right">3</td><td class=" dt-right">2</td><td class=" dt-right">1</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 66.67%, white 66.67%) repeat scroll 0% 0%;">66.67%</td></tr><tr role="row" class="odd"><td><a href="#">R/get_chunk.r</a></td><td class=" dt-right">79</td><td class=" dt-right">31</td><td class=" dt-right">21</td><td class=" dt-right">10</td><td>509</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 67.74%, white 67.74%) repeat scroll 0% 0%;">67.74%</td></tr><tr role="row" class="even"><td><a href="#">R/recommend_nchunks.r</a></td><td class=" dt-right">53</td><td class=" dt-right">15</td><td class=" dt-right">11</td><td class=" dt-right">4</td><td>17</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 73.33%, white 73.33%) repeat scroll 0% 0%;">73.33%</td></tr><tr role="row" class="odd"><td><a href="#">R/map.r</a></td><td class=" dt-right">268</td><td class=" dt-right">72</td><td class=" dt-right">53</td><td class=" dt-right">19</td><td>39</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 73.61%, white 73.61%) repeat scroll 0% 0%;">73.61%</td></tr><tr role="row" class="even"><td><a href="#">R/overwrite_check.r</a></td><td class=" dt-right">43</td><td class=" dt-right">16</td><td class=" dt-right">12</td><td class=" dt-right">4</td><td>211</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(252, 236, 233) 75%, white 75%) repeat scroll 0% 0%;">75.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/write_disk.frame.r</a></td><td class=" dt-right">55</td><td class=" dt-right">17</td><td class=" dt-right">13</td><td class=" dt-right">4</td><td>451</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 76.47%, white 76.47%) repeat scroll 0% 0%;">76.47%</td></tr><tr role="row" class="even"><td><a href="#">R/rbindlist.disk.frame.r</a></td><td class=" dt-right">77</td><td class=" dt-right">31</td><td class=" dt-right">24</td><td class=" dt-right">7</td><td>62</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 77.42%, white 77.42%) repeat scroll 0% 0%;">77.42%</td></tr><tr role="row" class="odd"><td><a href="#">R/shardkey.r</a></td><td class=" dt-right">14</td><td class=" dt-right">5</td><td class=" dt-right">4</td><td class=" dt-right">1</td><td>240</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 80%, white 80%) repeat scroll 0% 0%;">80.00%</td></tr><tr role="row" class="even"><td><a href="#">R/dplyr_verbs.r</a></td><td class=" dt-right">361</td><td class=" dt-right">51</td><td class=" dt-right">41</td><td class=" dt-right">10</td><td>132</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 80.39%, white 80.39%) repeat scroll 0% 0%;">80.39%</td></tr><tr role="row" class="odd"><td><a href="#">R/add_chunk.r</a></td><td class=" dt-right">137</td><td class=" dt-right">62</td><td class=" dt-right">50</td><td class=" dt-right">12</td><td>18</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 80.65%, white 80.65%) repeat scroll 0% 0%;">80.65%</td></tr><tr role="row" class="even"><td><a href="#">R/ncol-nrow.r</a></td><td class=" dt-right">66</td><td class=" dt-right">16</td><td class=" dt-right">13</td><td class=" dt-right">3</td><td>56</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 81.25%, white 81.25%) repeat scroll 0% 0%;">81.25%</td></tr><tr role="row" class="odd"><td><a href="#">R/full_join.r</a></td><td class=" dt-right">55</td><td class=" dt-right">29</td><td class=" dt-right">24</td><td class=" dt-right">5</td><td>10</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 82.76%, white 82.76%) repeat scroll 0% 0%;">82.76%</td></tr><tr role="row" class="even"><td><a href="#">R/semi_join.r</a></td><td class=" dt-right">55</td><td class=" dt-right">29</td><td class=" dt-right">24</td><td class=" dt-right">5</td><td>8</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 82.76%, white 82.76%) repeat scroll 0% 0%;">82.76%</td></tr><tr role="row" class="odd"><td><a href="#">R/anti_join.r</a></td><td class=" dt-right">69</td><td class=" dt-right">29</td><td class=" dt-right">24</td><td class=" dt-right">5</td><td>8</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 82.76%, white 82.76%) repeat scroll 0% 0%;">82.76%</td></tr><tr role="row" class="even"><td><a href="#">R/inner_join.r</a></td><td class=" dt-right">67</td><td class=" dt-right">36</td><td class=" dt-right">30</td><td class=" dt-right">6</td><td>8</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 83.33%, white 83.33%) repeat scroll 0% 0%;">83.33%</td></tr><tr role="row" class="odd"><td><a href="#">R/left_join.r</a></td><td class=" dt-right">58</td><td class=" dt-right">31</td><td class=" dt-right">26</td><td class=" dt-right">5</td><td>8</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 83.87%, white 83.87%) repeat scroll 0% 0%;">83.87%</td></tr><tr role="row" class="even"><td><a href="#">R/nchunks.r</a></td><td class=" dt-right">43</td><td class=" dt-right">7</td><td class=" dt-right">6</td><td class=" dt-right">1</td><td>279</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 85.71%, white 85.71%) repeat scroll 0% 0%;">85.71%</td></tr><tr role="row" class="odd"><td><a href="#">R/is_disk.frame.r</a></td><td class=" dt-right">40</td><td class=" dt-right">15</td><td class=" dt-right">13</td><td class=" dt-right">2</td><td>274</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 86.67%, white 86.67%) repeat scroll 0% 0%;">86.67%</td></tr><tr role="row" class="even"><td><a href="#">R/shard.r</a></td><td class=" dt-right">49</td><td class=" dt-right">16</td><td class=" dt-right">14</td><td class=" dt-right">2</td><td>140</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 87.5%, white 87.5%) repeat scroll 0% 0%;">87.50%</td></tr><tr role="row" class="odd"><td><a href="#">R/names.r</a></td><td class=" dt-right">34</td><td class=" dt-right">8</td><td class=" dt-right">7</td><td class=" dt-right">1</td><td>9</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 87.5%, white 87.5%) repeat scroll 0% 0%;">87.50%</td></tr><tr role="row" class="even"><td><a href="#">R/as.disk.frame.r</a></td><td class=" dt-right">41</td><td class=" dt-right">9</td><td class=" dt-right">8</td><td class=" dt-right">1</td><td>55</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 88.89%, white 88.89%) repeat scroll 0% 0%;">88.89%</td></tr><tr role="row" class="odd"><td><a href="#">R/rechunk.r</a></td><td class=" dt-right">142</td><td class=" dt-right">70</td><td class=" dt-right">63</td><td class=" dt-right">7</td><td>5</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(249, 255, 229) 90%, white 90%) repeat scroll 0% 0%;">90.00%</td></tr><tr role="row" class="even"><td><a href="#">R/map2.r</a></td><td class=" dt-right">94</td><td class=" dt-right">32</td><td class=" dt-right">29</td><td class=" dt-right">3</td><td>35</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 90.62%, white 90.62%) repeat scroll 0% 0%;">90.62%</td></tr><tr role="row" class="odd"><td><a href="#">R/get_chunk_ids.r</a></td><td class=" dt-right">38</td><td class=" dt-right">11</td><td class=" dt-right">10</td><td class=" dt-right">1</td><td>351</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 90.91%, white 90.91%) repeat scroll 0% 0%;">90.91%</td></tr><tr role="row" class="even"><td><a href="#">R/util.r</a></td><td class=" dt-right">26</td><td class=" dt-right">11</td><td class=" dt-right">10</td><td class=" dt-right">1</td><td>15</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 90.91%, white 90.91%) repeat scroll 0% 0%;">90.91%</td></tr><tr role="row" class="odd"><td><a href="#">R/data.table.r</a></td><td class=" dt-right">67</td><td class=" dt-right">17</td><td class=" dt-right">16</td><td class=" dt-right">1</td><td>11</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 94.12%, white 94.12%) repeat scroll 0% 0%;">94.12%</td></tr><tr role="row" class="even"><td><a href="#">R/merge.disk.frame.r</a></td><td class=" dt-right">98</td><td class=" dt-right">30</td><td class=" dt-right">29</td><td class=" dt-right">1</td><td>2</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 96.67%, white 96.67%) repeat scroll 0% 0%;">96.67%</td></tr><tr role="row" class="odd"><td><a href="#">R/zzz.r</a></td><td class=" dt-right">60</td><td class=" dt-right">12</td><td class=" dt-right">12</td><td class=" dt-right">0</td><td>6</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr><tr role="row" class="even"><td><a href="#">R/srckeep.disk.frame.r</a></td><td class=" dt-right">17</td><td class=" dt-right">3</td><td class=" dt-right">3</td><td class=" dt-right">0</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/compute.r</a></td><td class=" dt-right">23</td><td class=" dt-right">2</td><td class=" dt-right">2</td><td class=" dt-right">0</td><td>3</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr><tr role="row" class="even"><td><a href="#">R/delete.r</a></td><td class=" dt-right">12</td><td class=" dt-right">2</td><td class=" dt-right">2</td><td class=" dt-right">0</td><td>3</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr><tr role="row" class="odd"><td><a href="#">R/as.data.frame.r</a></td><td class=" dt-right">31</td><td class=" dt-right">2</td><td class=" dt-right">2</td><td class=" dt-right">0</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr><tr role="row" class="even"><td><a href="#">R/tbl_vars.r</a></td><td class=" dt-right">10</td><td class=" dt-right">1</td><td class=" dt-right">1</td><td class=" dt-right">0</td><td>1</td><td style="background: rgba(0, 0, 0, 0) linear-gradient(90deg, rgb(237, 253, 231) 100%, white 100%) repeat scroll 0% 0%;">100.00%</td></tr></tbody></table></div></div></div></div>
          <script type="application/json" data-for="htmlwidget-0338641141ef97f304a6">{"x":{"filter":"none","fillContainer":true,"data":[["<a href=\"#\">R/zip_to_disk.frame.r<\/a>","<a href=\"#\">R/sas2disk_frame.r<\/a>","<a href=\"#\">R/foverlaps.disk.frame.r<\/a>","<a href=\"#\">R/move_to.r<\/a>","<a href=\"#\">R/csv2disk.frame_readr.r<\/a>","<a href=\"#\">R/print.disk.frame.r<\/a>","<a href=\"#\">R/csv2disk.frame.r<\/a>","<a href=\"#\">R/setup.r<\/a>","<a href=\"#\">R/sample_n.R<\/a>","<a href=\"#\">R/disk.frame.r<\/a>","<a href=\"#\">R/collect.r<\/a>","<a href=\"#\">R/hard_group_by.r<\/a>","<a href=\"#\">R/remove_chunk.r<\/a>","<a href=\"#\">R/sample_frac.R<\/a>","<a href=\"#\">R/get_chunk.r<\/a>","<a href=\"#\">R/recommend_nchunks.r<\/a>","<a href=\"#\">R/map.r<\/a>","<a href=\"#\">R/overwrite_check.r<\/a>","<a href=\"#\">R/write_disk.frame.r<\/a>","<a href=\"#\">R/rbindlist.disk.frame.r<\/a>","<a href=\"#\">R/shardkey.r<\/a>","<a href=\"#\">R/dplyr_verbs.r<\/a>","<a href=\"#\">R/add_chunk.r<\/a>","<a href=\"#\">R/ncol-nrow.r<\/a>","<a href=\"#\">R/full_join.r<\/a>","<a href=\"#\">R/semi_join.r<\/a>","<a href=\"#\">R/anti_join.r<\/a>","<a href=\"#\">R/inner_join.r<\/a>","<a href=\"#\">R/left_join.r<\/a>","<a href=\"#\">R/nchunks.r<\/a>","<a href=\"#\">R/is_disk.frame.r<\/a>","<a href=\"#\">R/shard.r<\/a>","<a href=\"#\">R/names.r<\/a>","<a href=\"#\">R/as.disk.frame.r<\/a>","<a href=\"#\">R/rechunk.r<\/a>","<a href=\"#\">R/map2.r<\/a>","<a href=\"#\">R/get_chunk_ids.r<\/a>","<a href=\"#\">R/util.r<\/a>","<a href=\"#\">R/data.table.r<\/a>","<a href=\"#\">R/merge.disk.frame.r<\/a>","<a href=\"#\">R/zzz.r<\/a>","<a href=\"#\">R/srckeep.disk.frame.r<\/a>","<a href=\"#\">R/compute.r<\/a>","<a href=\"#\">R/delete.r<\/a>","<a href=\"#\">R/as.data.frame.r<\/a>","<a href=\"#\">R/tbl_vars.r<\/a>"],[114,75,101,66,39,16,197,86,9,236,75,178,44,25,79,53,268,43,55,77,14,361,137,66,55,55,69,67,58,43,40,49,34,41,142,94,38,26,67,98,60,17,23,12,31,10],[45,40,36,22,7,6,115,22,3,96,16,65,11,3,31,15,72,16,17,31,5,51,62,16,29,29,29,36,31,7,15,16,8,9,70,32,11,11,17,30,12,3,2,2,2,1],[0,0,0,0,0,0,12,3,1,33,6,29,7,2,21,11,53,12,13,24,4,41,50,13,24,24,24,30,26,6,13,14,7,8,63,29,10,10,16,29,12,3,2,2,2,1],[45,40,36,22,7,6,103,19,2,63,10,36,4,1,10,4,19,4,4,7,1,10,12,3,5,5,5,6,5,1,2,2,1,1,7,3,1,1,1,1,0,0,0,0,0,0],["0","0","0","0","0","0","0","1","0","139","16","19","1","1","509","17","39","211","451","62","240","132","18","56","10","8","8","8","8","279","274","140","9","55","5","35","351","15","11","2","6","1","3","3","1","1"],["0.00%","0.00%","0.00%","0.00%","0.00%","0.00%","10.43%","13.64%","33.33%","34.38%","37.50%","44.62%","63.64%","66.67%","67.74%","73.33%","73.61%","75.00%","76.47%","77.42%","80.00%","80.39%","80.65%","81.25%","82.76%","82.76%","82.76%","83.33%","83.87%","85.71%","86.67%","87.50%","87.50%","88.89%","90.00%","90.62%","90.91%","90.91%","94.12%","96.67%","100.00%","100.00%","100.00%","100.00%","100.00%","100.00%"]],"container":"<table class=\"row-border fill-container\">\n  <thead>\n    <tr>\n      <th>File<\/th>\n      <th>Lines<\/th>\n      <th>Relevant<\/th>\n      <th>Covered<\/th>\n      <th>Missed<\/th>\n      <th>Hits / Line<\/th>\n      <th>Coverage<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"dom":"t","paging":false,"columnDefs":[{"targets":6,"createdCell":"function(td, cellData, rowData, row, col) {\n  var percent = cellData.replace(\"%\", \"\");\n  if (percent > 90) {\n    var grad = \"linear-gradient(90deg, #edfde7 \" + cellData + \", white \" + cellData + \")\";\n  } else if (percent > 75) {\n    var grad = \"linear-gradient(90deg, #f9ffe5 \" + cellData + \", white \" + cellData + \")\";\n  } else {\n    var grad = \"linear-gradient(90deg, #fcece9 \" + cellData + \", white \" + cellData + \")\";\n  }\n  $(td).css(\"background\", grad);\n}\n"},{"className":"dt-right","targets":[1,2,3,4]}],"order":[],"autoWidth":false,"orderClasses":false},"callback":"function(table) {\ntable.on('click.dt', 'a', function() {\n  files = $('div#files div');\n  files.not('div.hidden').addClass('hidden');\n  id = $(this).text();\n  files.filter('div[id=\\'' + id + '\\']').removeClass('hidden');\n  $('ul.nav a[data-value=Source]').text(id).tab('show');\n});\n}"},"evals":["options.columnDefs.0.createdCell","callback"],"jsHooks":[]}</script>
        </div>
        <div class="tab-pane" title="Source" data-value="Source" id="tab-covr-2">
          <div id="files">
            <div id="R/full_join.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' join.df = full_join(cars.df, cars.df, merge_by_chunk_id = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(join.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">full_join.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_full_join"</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">merge_by_chunk_id</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">12</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># full join cannot be support for y in data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dy</span> <span class="operator">=</span> <span class="identifier">shard</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">ncx</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dx</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">full_join.disk.frame</span><span class="paren">(</span><span class="identifier">dx</span>, <span class="identifier">dy</span>, <span class="identifier">by</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="identifier">copy</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">25</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"both x and y are disk.frames. You need to specify merge_by_chunk_id = TRUE or FALSE explicitly"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">28</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncy</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"merge_by_chunk_id = FALSE. This will take significantly longer and the preparations needed are performed eagerly which may lead to poor performance. Consider making y a data.frame or set merge_by_chunk_id = TRUE for better performance."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">full_join.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map2</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">37<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">full_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># TODO if the shardkey are the same and only the shardchunks are different then just shard again on one of them is fine</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"merge_by_chunk_id is TRUE but shardkey(x) does NOT equal to shardkey(y). You may want to perform a hard_group_by() on both x and/or y or set merge_by_chunk_id = FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/rbindlist.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' rbindlist disk.frames together</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df_list A list of disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir Output directory of the row-bound disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param by_chunk_id If TRUE then only the chunks with the same chunk IDs will be bound</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param parallel if TRUE then bind multiple disk.frame simultaneously, Defaults to TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress 0-100, 100 being the highest compression rate.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .progress A logical, for whether or not to print a progress bar for multiprocess, multisession, and multicore plans. From {furrr}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table data.table setDT</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future.apply future_lapply</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr map_chr map_dfr map map_lgl</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom assertthat assert_that</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # row-bind two disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2.df = rbindlist.disk.frame(list(cars.df, cars.df))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rbindlist.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df_list</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">parallel</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">compress</span><span class="operator">=</span><span class="number">50</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">48<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">assertthat</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">assert_that</span><span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">df_list</span><span class="paren">)</span> <span class="operator">==</span> <span class="string">"list"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">48<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">48<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">df_list</span>, <span class="operator">~</span><span class="identifier">assertthat</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">assert_that</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span>, <span class="identifier">msg</span> <span class="operator">=</span> <span class="string">"error running rbindlist.disk.frame: Not every element of df_list is a disk.frame"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">by_chunk_id</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">list_of_paths</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_chr</span><span class="paren">(</span><span class="identifier">df_list</span>, <span class="operator">~</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">list_of_chunks</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">list_of_paths</span>, <span class="operator">~</span><span class="identifier">data.table</span><span class="paren">(</span><span class="identifier">path</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span>,<span class="identifier">full_path</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">list_of_chunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># split the list of chunks into lists for easy operation with future</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">slist</span> <span class="operator">=</span> <span class="identifier">split</span><span class="paren">(</span><span class="identifier">list_of_chunks</span><span class="operator">$</span><span class="identifier">full_path</span>,<span class="identifier">list_of_chunks</span><span class="operator">$</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">parallel</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#system.time(future.apply::future_lapply(1:length(slist), function(i) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">.progress</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="string">"Appending disk.frames: "</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">system.time</span><span class="paren">(</span><span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_map</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">slist</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">full_paths1</span> <span class="operator">=</span> <span class="identifier">slist</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outfilename</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">slist</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">full_paths1</span>, <span class="operator">~</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span>,<span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>,<span class="identifier">outfilename</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="identifier">.progress</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">system.time</span><span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">slist</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">full_paths1</span> <span class="operator">=</span> <span class="identifier">slist</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">54</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outfilename</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">slist</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">full_paths1</span>, <span class="operator">~</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span>,<span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>,<span class="identifier">outfilename</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">56</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rbind_res</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shardkeys</span> <span class="operator">&lt;-</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">df_list</span>, <span class="identifier">shardkey</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if all the sharkeys are identical then</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">##browser</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_lgl</span><span class="paren">(</span><span class="identifier">shardkeys</span><span class="paren">[</span><span class="operator">-</span><span class="number">1</span><span class="paren">]</span>, <span class="operator">~</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">shardkeys</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">rbind_res</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardkeys</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="operator">$</span><span class="identifier">shardkey</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">shardkeys</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span><span class="operator">$</span><span class="identifier">shardchunks</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">70</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">rbind_res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">75</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"For rbindlist.disk.frame, only by_chunk_id = TRUE is implemented"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/hard_group_by.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Show a progress bar of the action being performed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils txtProgressBar setTxtProgressBar</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">progressbar</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">6</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"performing"</span><span class="paren">)</span> <span class="operator">==</span> <span class="string">"hard_group_by"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># create progress bar</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">9</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shardby</span> <span class="operator">=</span> <span class="string">"acct_id"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#list.files(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">11</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fparent</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"parent"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#tmp = file.path(fparent,".performing","inchunks")</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">14</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmp</span> <span class="operator">=</span> <span class="string">"tmphardgroupby2"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">16</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">l</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">fparent</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">17</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">pt_begin_split</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">18</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">doprog</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">pt_from</span>, <span class="identifier">sleep</span> <span class="operator">=</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#tkpb = winProgressBar(title = sprintf("Hard Group By Stage 1(/2) - %s", shardby), label = "Checking completeness",</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#                      min = 0, max = l*1.5, initial = 0, width = 500)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">21</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">pb</span> <span class="operator">&lt;-</span> <span class="identifier">txtProgressBar</span><span class="paren">(</span><span class="identifier">min</span> <span class="operator">=</span> <span class="number">0</span>, <span class="identifier">max</span> <span class="operator">=</span> <span class="identifier">l</span><span class="operator">*</span><span class="number">1.5</span>, <span class="identifier">style</span> <span class="operator">=</span> <span class="number">3</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">23</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">on.exit</span><span class="paren">(</span><span class="identifier">close</span><span class="paren">(</span><span class="identifier">pb</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># on.exit(close(tkpb))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">25</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">while</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmp</span>,<span class="identifier">l</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&lt;</span> <span class="identifier">l</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">26</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">wl</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmp</span>,<span class="number">1</span><span class="operator">:</span><span class="identifier">l</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="identifier">l</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">27</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">tt</span> <span class="operator">&lt;-</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span> <span class="operator">-</span> <span class="identifier">pt_from</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#list.files(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">29</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">avg_speed</span> <span class="operator">=</span> <span class="identifier">tt</span><span class="operator">/</span><span class="identifier">wl</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pred_speed</span> <span class="operator">=</span> <span class="identifier">avg_speed</span><span class="operator">*</span><span class="paren">(</span><span class="identifier">l</span><span class="operator">-</span><span class="identifier">wl</span><span class="paren">)</span> <span class="operator">+</span> <span class="identifier">avg_speed</span><span class="operator">*</span><span class="identifier">l</span><span class="operator">/</span><span class="number">2</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">elapsed</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">tt</span><span class="operator">/</span><span class="number">60</span>,<span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#setWinProgressBar(tkpb, wl, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#                  title = sprintf("Hard Group By Stage 1(/2) - %s", shardby),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#                  label = sprintf("%.0f out of %d; avg speed %.2f mins; elapsed %.1f mins; another %.1f mins", wl,l, round(avg_speed/60,2), elapsed, round(pred_speed/60,2)))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">36</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">setTxtProgressBar</span><span class="paren">(</span><span class="identifier">pb</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmp</span>,<span class="identifier">l</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">title</span> <span class="operator">=</span> <span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"Group By - %s"</span>, <span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">38</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">Sys.sleep</span><span class="paren">(</span><span class="identifier">sleep</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">doprog</span><span class="paren">(</span><span class="identifier">pt_begin_split</span>, <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">pt_begin_collate</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">doprog2</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">pt_from</span>, <span class="identifier">sleep</span> <span class="operator">=</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># tkpb = winProgressBar(title = sprintf("Hard Group By - %s -- Stage 2 (of 2) collating", shardby), label = "Checking completeness",</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                            <span class="comment"># min = 0, max = l*1.5, initial = 0, width = 600)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">pb</span> <span class="operator">&lt;-</span> <span class="identifier">txtProgressBar</span><span class="paren">(</span><span class="identifier">min</span> <span class="operator">=</span> <span class="number">0</span>, <span class="identifier">max</span> <span class="operator">=</span> <span class="identifier">l</span><span class="operator">*</span><span class="number">1.5</span>, <span class="identifier">style</span> <span class="operator">=</span> <span class="number">3</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">49</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">on.exit</span><span class="paren">(</span><span class="identifier">close</span><span class="paren">(</span><span class="identifier">pb</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># on.exit(close(tkpb))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">51</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">while</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="string">"large_sorted"</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">&lt;</span> <span class="identifier">l</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">wl</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="string">"large_sorted"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">tt</span> <span class="operator">&lt;-</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span> <span class="operator">-</span> <span class="identifier">pt_from</span><span class="paren">[</span><span class="number">3</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#list.files(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">avg_speed</span> <span class="operator">=</span> <span class="identifier">tt</span><span class="operator">/</span><span class="identifier">wl</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">56</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pred_speed</span> <span class="operator">=</span> <span class="identifier">avg_speed</span><span class="operator">*</span><span class="paren">(</span><span class="identifier">l</span><span class="operator">-</span><span class="identifier">wl</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">57</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">elapsed</span> <span class="operator">=</span> <span class="identifier">round</span><span class="paren">(</span><span class="identifier">tt</span><span class="operator">/</span><span class="number">60</span>,<span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># setWinProgressBar(tkpb, l + wl/2, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#                   title = sprintf("Hard Group By - %s -- Stage 2 (of 2) collating -- %.0f out of %d chunks processed;", shardby, wl, l),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#                   label = sprintf("avg %.2f min/chunk; %.1f mins elapsed; %.1f mins remaining;", round(avg_speed/60,2), elapsed, round(pred_speed/60,2)))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">setTxtProgressBar</span><span class="paren">(</span><span class="identifier">pb</span>, <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="string">"large_sorted"</span><span class="paren">)</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">63</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                          <span class="identifier">title</span> <span class="operator">=</span> <span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"Hard Group By - %s"</span>, <span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">Sys.sleep</span><span class="paren">(</span><span class="identifier">sleep</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">67</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">doprog2</span><span class="paren">(</span><span class="identifier">pt_begin_collate</span>, <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Perform a hard group</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A hard_group_by is a group by that also reorganizes the chunks to ensure that</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' every unique grouping of `by`` is in the same chunk. Or in other words, every</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' row that share the same `by` value will end up in the same chunk.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... grouping variables</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks The number of chunks in the output. Defaults = nchunks.disk.frame(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite the out put directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param add same as dplyr::group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .drop same as dplyr::group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' iris.df = as.disk.frame(iris, nchunks = 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # group_by iris.df by specifies and ensure rows with the same specifies are in the same chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' iris_hard.df = hard_group_by(iris.df, Species)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">89</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(iris_hard.df, 1)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(iris_hard.df, 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">92</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">93</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(iris.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(iris_hard.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">hard_group_by</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">add</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">.drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">97</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"hard_group_by"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname hard_group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">102</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">hard_group_by.data.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">add</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">.drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">add</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">.drop</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname hard_group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">hard_group_by.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_hard_group_by"</span><span class="paren">)</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">113</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">115</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ff</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">116</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># test if the unlist it will error</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">119</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">tryCatch</span><span class="paren">(</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># This will return the variable names</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># TODO use better ways to do NSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># the below will fail if indeed ... can not be list-ed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># there should be a better way to do this</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">125</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">unlist</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># shard and create temporary diskframes</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmp_df</span>  <span class="operator">=</span> <span class="identifier">map</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">129</td>
                    <td class="coverage">201<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">tmpdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">130</td>
                    <td class="coverage">201<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shard</span><span class="paren">(</span><span class="identifier">df1</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tmpdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">131</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># now rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">135</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">rbindlist.disk.frame</span><span class="paren">(</span><span class="identifier">tmp_df</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># clean up the tmp dir</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">138</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">walk</span><span class="paren">(</span><span class="identifier">tmp_df</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">139</td>
                    <td class="coverage">201<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">143</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res1</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">144</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span> <span class="operator">==</span> <span class="string">"character"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">145</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">'res1 = group_by(res, {paste(by,collapse=",")})'</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">146</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">147</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res1</span> <span class="operator">=</span> <span class="identifier">res</span> <span class="operator">%&gt;%</span> <span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by</span><span class="paren">(</span><span class="paren">{</span><span class="paren">{</span><span class="identifier">by</span><span class="paren">}</span><span class="paren">}</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">148</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">149</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">'res1 = group_by(res, {paste(by,collapse=",")})'</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">152</td>
                    <td class="coverage">44<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">153</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span>, <span class="identifier">error</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">154</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#message(e)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># This will return the variable names</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">156</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="operator">%&gt;%</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">157</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">substr</span><span class="paren">(</span><span class="number">2</span>, <span class="identifier">nchar</span><span class="paren">(</span>.<span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># shard and create temporary diskframes</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">160</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmp_df</span>  <span class="operator">=</span> <span class="identifier">map</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">161</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">##browser</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">162</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">tmpdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">163</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shard</span><span class="paren">(</span><span class="identifier">df1</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tmpdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">164</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># now rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">167</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">rbindlist.disk.frame</span><span class="paren">(</span><span class="identifier">tmp_df</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># clean up the tmp dir</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">170</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">walk</span><span class="paren">(</span><span class="identifier">tmp_df</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">171</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">174</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res1</span> <span class="operator">=</span> <span class="identifier">res</span> <span class="operator">%&gt;%</span> <span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by</span><span class="paren">(</span><span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">syms</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">176</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">177</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/rechunk.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Increase or decrease the number of chunks in the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df the disk.frame to rechunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby the shardkeys</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # create a disk.frame with 2 chunks in tempdir()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars, nchunks = 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # re-chunking cars.df to 3 chunks, done "in-place" to the same folder as cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' rechunk(cars.df, 3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' new_path = tempfile(fileext = ".df")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # re-chunking cars.df to 4 chunks, shard by speed, and done "out-of-place" to a new directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2.df = rechunk(cars.df, 4, outdir=new_path, shardby = "speed")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rechunk</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">nchunks</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># we need to force the chunks to be computed first as it's common to make nchunks a multiple of chunks(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># but if we do it too late then the folder could be empty</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">force</span><span class="paren">(</span><span class="identifier">nchunks</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">nchunks</span> <span class="operator">&lt;</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">28</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"nchunks must be larger than 1"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">user_had_not_set_shard_by</span> <span class="operator">=</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># back up the files if writing to the same directory</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">outdir</span> <span class="operator">==</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">back_up_tmp_dir</span> <span class="operator">&lt;-</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"back_up_tmp_dir"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">back_up_tmp_dir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_copy</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span><span class="paren">)</span>, <span class="comment">#from</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">back_up_tmp_dir</span>, <span class="string">".metadata"</span><span class="paren">)</span> <span class="comment">#to</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># back-up the files first</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">full_files</span> <span class="operator">=</span> <span class="identifier">dir</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">short_files</span> <span class="operator">=</span> <span class="identifier">dir</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># move all files to the back up folder</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">full_files</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_move</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">back_up_tmp_dir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># TODO check for validity</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">message</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"files have been backed up to temporary dir {back_up_tmp_dir}. You can recover there files until you restart your R session"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">back_up_tmp_dir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dfp</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">existing_shardkey</span> <span class="operator">=</span> <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># by default, if shardkey is defined then rechunk will continue to reuse it</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">70</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">71</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">existing_shardkey</span><span class="paren">[</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardby</span>, <span class="string">""</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">76</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nr</span> <span class="operator">=</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nr_per_chunk</span> <span class="operator">=</span> <span class="identifier">ceiling</span><span class="paren">(</span><span class="identifier">nr</span><span class="operator">/</span><span class="identifier">nchunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">used_so_far</span> <span class="operator">=</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">done</span> <span class="operator">=</span> <span class="literal">FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">chunks_read</span> <span class="operator">=</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">81</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">chunks_written</span> <span class="operator">=</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">used_so_far</span> <span class="operator">=</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">a</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">while</span><span class="paren">(</span><span class="identifier">chunks_read</span> <span class="operator">&lt;</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">30<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">nr_per_chunk</span> <span class="operator">&lt;=</span> <span class="identifier">used_so_far</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">add_chunk</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">a</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nr_per_chunk</span>,<span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunks_written</span> <span class="operator">=</span> <span class="identifier">chunks_written</span> <span class="operator">+</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">a</span><span class="paren">[</span><span class="operator">-</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nr_per_chunk</span><span class="paren">)</span>,<span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">used_so_far</span> <span class="operator">=</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">a</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunks_read</span> <span class="operator">=</span> <span class="identifier">chunks_read</span> <span class="operator">+</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">newa</span> <span class="operator">=</span> <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunks_read</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">94</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">used_so_far</span> <span class="operator">=</span> <span class="identifier">used_so_far</span> <span class="operator">+</span> <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">newa</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">95</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">rbindlist</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">a</span>, <span class="identifier">newa</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">newa</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">100</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">while</span><span class="paren">(</span><span class="identifier">chunks_written</span> <span class="operator">&lt;</span> <span class="identifier">nchunks</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">101</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rows_to_write</span> <span class="operator">=</span> <span class="identifier">min</span><span class="paren">(</span><span class="identifier">nr_per_chunk</span>, <span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">a</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">add_chunk</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">a</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="identifier">rows_to_write</span>,<span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">103</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">a</span><span class="paren">[</span><span class="operator">-</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">rows_to_write</span><span class="paren">)</span>,<span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">chunks_written</span> <span class="operator">=</span> <span class="identifier">chunks_written</span> <span class="operator">+</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">107</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">109</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">user_had_not_set_shard_by</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">110</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"shardby = NULL; but there are already shardkey's defined for this disk.frame. Therefore a rechunk algorithm that preserves the shardkey's has been applied and this algorithm is slower than an algorithm that doesn't use a shardkey."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># using some maths we can cut down on the number of operations</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">114</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nc</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">115</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if the number of possible new chunk ids is one then no need to perform anything. just merge those</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">possibles_new_chunk_id</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nc</span>, <span class="operator">~</span><span class="identifier">unique</span><span class="paren">(</span><span class="paren">(</span><span class="identifier">.x</span><span class="operator">-</span><span class="number">1</span> <span class="operator">+</span> <span class="paren">(</span><span class="number">0</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">nchunks</span><span class="operator">-</span><span class="number">1</span><span class="paren">)</span><span class="paren">)</span><span class="operator">*</span><span class="identifier">nc</span><span class="paren">)</span> <span class="operator">%%</span> <span class="identifier">nchunks</span><span class="paren">)</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">117</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lp</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_int</span><span class="paren">(</span><span class="identifier">possibles_new_chunk_id</span>,<span class="identifier">length</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#need to shards</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">120</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nts</span> <span class="operator">=</span> <span class="identifier">which</span><span class="paren">(</span><span class="identifier">lp</span> <span class="operator">!=</span> <span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">bad_boys</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="identifier">nts</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">123</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">df1</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">124</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">shard</span><span class="paren">(</span><span class="identifier">df1</span>, <span class="identifier">shardby</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># for those that don't need to be resharded</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">oks</span> <span class="operator">=</span> <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_map</span><span class="paren">(</span><span class="identifier">which</span><span class="paren">(</span><span class="identifier">lp</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">i</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">129</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">file_chunk</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span>, <span class="identifier">i</span> <span class="operator">%&gt;%</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">130</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">tmp_fdlr</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"rechunk_shard"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">131</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">tmp_fdlr</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">132</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_move</span><span class="paren">(</span><span class="identifier">file_chunk</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmp_fdlr</span>, <span class="identifier">possibles_new_chunk_id</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">%&gt;%</span> <span class="identifier">paste0</span><span class="paren">(</span><span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">133</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">tmp_fdlr</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">136</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">list_of_sharded</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">bad_boys</span>, <span class="identifier">oks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">137</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">new_one</span> <span class="operator">&lt;-</span> <span class="identifier">rbindlist.disk.frame</span><span class="paren">(</span><span class="identifier">list_of_sharded</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">outdir</span>, <span class="identifier">by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">139</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">new_one</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">new_one</span><span class="paren">)</span>, <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">140</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/dplyr_verbs.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' A function to make it easier to create dplyr function for disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param dplyr_fn The dplyr function to create a mapper for</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param warning_msg The warning message to display when invoking the mapper</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom rlang enquos quo</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">create_dplyr_mapper</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">dplyr_fn</span>, <span class="identifier">warning_msg</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">7</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">return_func</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">8</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">warning_msg</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">9</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">warning_msg</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">12</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># this is designed to capture any global stuff</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">vars_and_pkgs</span> <span class="operator">=</span> <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">getGlobalsAndPackages</span><span class="paren">(</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">data_for_eval_tidy</span> <span class="operator">=</span> <span class="identifier">force</span><span class="paren">(</span><span class="identifier">vars_and_pkgs</span><span class="operator">$</span><span class="identifier">globals</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">42<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">this_env</span> <span class="operator">=</span> <span class="identifier">environment</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">42<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">22</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">for</span><span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">23</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">assign</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">data_for_eval_tidy</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">pos</span> <span class="operator">=</span> <span class="identifier">this_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">42<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">quo_dotdotdot</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">47<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">".Environment"</span><span class="paren">)</span> <span class="operator">=</span> <span class="identifier">this_env</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">42<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">quo</span><span class="paren">(</span><span class="identifier">dplyr_fn</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">42<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span><span class="operator">=</span><span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as_label</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">this_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">return_func</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The dplyr verbs implemented for disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Please see the dplyr document for their usage. Please note that `group_by`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' and `arrange` performs the actions within each chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr select rename filter mutate transmute arrange do groups group_by group_by glimpse summarise</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... Same as the dplyr functions</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .data a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' library(dplyr)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' library(magrittr)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' mult = 2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # use all any of the supported dplyr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2 = cars.df %&gt;% </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   select(speed) %&gt;% </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   mutate(speed2 = speed * mult) %&gt;% </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   filter(speed &lt; 50) %&gt;% </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   rename(speed1 = speed) %&gt;% </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   collect</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">select.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">map</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">29<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">quo</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">select</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">29<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">eval_tidy</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rename.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rename</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">filter.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">filter</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr filter_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">filter_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">filter_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">89</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">92</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr filter_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">93</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">filter_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">filter_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr filter_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">filter_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">filter_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">102</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future getGlobalsAndPackages</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom rlang eval_tidy quo enquos</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr mutate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">107</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">mutate.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">mutate</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr transmute</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">transmute.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">transmute</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">115</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">116</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr arrange</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">arrange.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">arrange</span>, <span class="string">"disk.frame only sorts (arange) WITHIN each chunk"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarise</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarise.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarise</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">128</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">129</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr tally</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">tally.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">tally</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr count</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">count.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">count</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># TODO alot of these .disk.frame functions are not generic</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr add_count</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">144</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">145</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">add_count.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">add_count</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">146</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">148</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">149</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr add_tally</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">add_tally.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">add_tally</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">152</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">153</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">154</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarize</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarize.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarize</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">160</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">161</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">162</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr do</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">do.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">do</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">164</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr group_by_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">group_by_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">171</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">174</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr group_by_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">group_by_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">176</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">177</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">180</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr group_by_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">181</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">group_by_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">183</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">185</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">186</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr mutate_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">187</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">mutate_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">mutate_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">189</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">191</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr mutate_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">193</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">mutate_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">mutate_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">194</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">197</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">198</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr mutate_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">199</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">mutate_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">mutate_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">202</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">203</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">204</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr rename_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">205</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rename_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rename_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">206</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">208</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">210</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr rename_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">211</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rename_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rename_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">212</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">213</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">215</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">216</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr rename_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">217</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">rename_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rename_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">218</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">219</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">220</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">221</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">222</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr select_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">223</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">select_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">select_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">224</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">225</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">226</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">227</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr select_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">229</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">select_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">select_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">230</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">231</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">232</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">233</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr select_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">select_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">select_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">236</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">238</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">240</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarise_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarise_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarise_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">242</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">243</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">246</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarise_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">247</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarise_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarise_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">248</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">249</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">250</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">251</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">252</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarize</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">253</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarize.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarize</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">254</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">255</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">257</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarize_all</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">259</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarize_all.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarize_all</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">260</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">264</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarize_at</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">265</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarize_at.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarize_at</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">266</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">267</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">268</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">269</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">270</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr summarize_if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">271</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">summarize_if.disk.frame</span> <span class="operator">&lt;-</span> <span class="identifier">create_dplyr_mapper</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">summarize_if</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">272</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">273</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The shard keys of the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">274</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return character</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">275</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">276</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">277</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">groups.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">278</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">279</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">280</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">281</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Group by within each disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">282</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">283</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The disk.frame group by operation perform group WITHIN each chunk. This is</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">284</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' often used for performance reasons. If the user wishes to perform group-by,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">285</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' they may choose to use the `hard_group_by` function which is expensive as it</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">286</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' reorganizes the chunks by the shard key.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">287</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @seealso hard_group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">288</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .data a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">289</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... same as the dplyr::group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">290</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">291</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @family dplyr verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">292</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">293</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># TODO check shardkey</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">294</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">group_by.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">295</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dplyr_fn</span> <span class="operator">=</span> <span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">group_by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">296</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">297</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">298</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">299</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># this is designed to capture any global stuff</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">300</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">vars_and_pkgs</span> <span class="operator">=</span> <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">getGlobalsAndPackages</span><span class="paren">(</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">301</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data_for_eval_tidy</span> <span class="operator">=</span> <span class="identifier">force</span><span class="paren">(</span><span class="identifier">vars_and_pkgs</span><span class="operator">$</span><span class="identifier">globals</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">302</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">303</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">304</td>
                    <td class="coverage">238<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">this_env</span> <span class="operator">=</span> <span class="identifier">environment</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">305</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">306</td>
                    <td class="coverage">238<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">307</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">for</span><span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">308</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">assign</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">data_for_eval_tidy</span><span class="paren">)</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">data_for_eval_tidy</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span>, <span class="identifier">pos</span> <span class="operator">=</span> <span class="identifier">this_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">309</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">310</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">311</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">312</td>
                    <td class="coverage">238<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">quo_dotdotdot</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">313</td>
                    <td class="coverage">304<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">".Environment"</span><span class="paren">)</span> <span class="operator">=</span> <span class="identifier">this_env</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">314</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">315</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">316</td>
                    <td class="coverage">238<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">quo</span><span class="paren">(</span><span class="identifier">dplyr_fn</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">317</td>
                    <td class="coverage">238<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span><span class="operator">=</span><span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as_label</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">this_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">318</td>
                    <td class="coverage">46<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">319</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">320</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#group_by.disk.frame &lt;- create_dplyr_mapper(dplyr::group_by, "The group_by operation is applied WITHIN each chunk, hence the results may not be as expected. To address this issue, you can rechunk(df, shardby = your_group_keys) which can be computationally expensive. Otherwise, you may use a second stage summary to obtain the desired result.")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">321</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">322</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">323</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname dplyr_verbs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">324</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">glimpse.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">325</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">glimpse</span><span class="paren">(</span><span class="identifier">head</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="keyword">...</span><span class="paren">)</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">326</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">327</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">328</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Internal methods</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">329</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># @param .data the data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">330</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># @param cmd the function to record</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">331</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">record</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="identifier">cmd</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">332</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.data</span>,<span class="string">"lazyfn"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.data</span>,<span class="string">"lazyfn"</span><span class="paren">)</span>, <span class="identifier">list</span><span class="paren">(</span><span class="identifier">cmd</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">333</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">.data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">334</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">335</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">336</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Internal methods</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">337</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># @param .data the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">338</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># @param cmds the list of function to play back</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">339</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">play</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.data</span>, <span class="identifier">cmds</span><span class="operator">=</span><span class="literal">NULL</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">340</td>
                    <td class="coverage">334<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">for</span> <span class="paren">(</span><span class="identifier">cmd</span> <span class="keyword">in</span> <span class="identifier">cmds</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">341</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">cmd</span><span class="paren">)</span> <span class="operator">==</span> <span class="string">"closure"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">342</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">.data</span> <span class="operator">&lt;-</span> <span class="identifier">cmd</span><span class="paren">(</span><span class="identifier">.data</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">343</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">344</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># create a temporary environment </span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">345</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">an_env</span> <span class="operator">=</span> <span class="identifier">new.env</span><span class="paren">(</span><span class="identifier">parent</span> <span class="operator">=</span> <span class="identifier">environment</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">346</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">347</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ng</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">cmd</span><span class="operator">$</span><span class="identifier">vars_and_pkgs</span><span class="operator">$</span><span class="identifier">globals</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">348</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">349</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">ng</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">350</td>
                    <td class="coverage">319<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">for</span><span class="paren">(</span><span class="identifier">i</span> <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">cmd</span><span class="operator">$</span><span class="identifier">vars_and_pkgs</span><span class="operator">$</span><span class="identifier">globals</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">351</td>
                    <td class="coverage">879<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">g</span> <span class="operator">=</span> <span class="identifier">cmd</span><span class="operator">$</span><span class="identifier">vars_and_pkgs</span><span class="operator">$</span><span class="identifier">globals</span><span class="paren">[</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">352</td>
                    <td class="coverage">879<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">assign</span><span class="paren">(</span><span class="identifier">ng</span><span class="paren">[</span><span class="identifier">i</span><span class="paren">]</span>, <span class="identifier">g</span>, <span class="identifier">pos</span> <span class="operator">=</span> <span class="identifier">an_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">353</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">354</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">355</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">.data</span> <span class="operator">&lt;-</span> <span class="identifier">do.call</span><span class="paren">(</span><span class="identifier">cmd</span><span class="operator">$</span><span class="identifier">func</span>, <span class="identifier">list</span><span class="paren">(</span><span class="identifier">.data</span><span class="paren">)</span>, <span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">an_env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">356</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">357</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">358</td>
                    <td class="coverage">334<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">.data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">359</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">360</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">361</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/foverlaps.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Apply data.table's foverlaps to the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description EXPERIMENTAL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df1 A disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df2 A disk.frame or a data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param by.x character/string vector. by.x used in foverlaps</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param by.y character/string vector. by.x used in foverlaps</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The output directory of the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param merge_by_chunk_id If TRUE then the merges will happen for chunks in df1 and df2 with the same chunk id which speed up processing. Otherwise every chunk of df1 is merged with every chunk of df2. Ignored with df2 is not a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress The compression ratio for fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite existing directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to data.table::foverlaps and disk.frame::map.disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table foverlaps data.table setDT setkeyv</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future.apply future_lapply</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' library(data.table)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' ## simple example:</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' x = as.disk.frame(data.table(start=c(5,31,22,16), end=c(8,50,25,18), val2 = 7:10))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' y = as.disk.frame(data.table(start=c(10, 20, 30), end=c(15, 35, 45), val1 = 1:3))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' xy.df = foverlaps.disk.frame(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   x, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   y, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   by.x = c("val1", "start", "end"), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   by.y = c("val1", "start", "end"), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   merge_by_chunk_id = TRUE, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(x)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(y)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(xy.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">foverlaps.disk.frame</span> <span class="operator">&lt;-</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">function</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df1</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df2</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">by.x</span> <span class="operator">=</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span> <span class="keyword">else</span> <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df2</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">by.y</span> <span class="operator">=</span> <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df2</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">...</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">outdir</span> <span class="operator">=</span> <span class="paren">{</span><span class="keyword">warning</span><span class="paren">(</span><span class="string">"temp dir create"</span><span class="paren">)</span>; <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"df_foverlaps_tmp"</span>, <span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span><span class="paren">}</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">compress</span><span class="operator">=</span><span class="number">50</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">50</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df2</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">51</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="identifier">df1</span>, <span class="operator">~</span><span class="identifier">foverlaps</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">df2</span>, <span class="keyword">...</span><span class="paren">)</span>, <span class="keyword">...</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">|</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df1</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">df2</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if the shardkeys are the same then only need to match by segment id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># as account with the same shardkey must end up in the same segment</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path1</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df1</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">56</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df2</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">58</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df3</span> <span class="operator">=</span> <span class="identifier">merge</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">60</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">61</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pathA</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">file_id</span> <span class="operator">=</span> <span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path2</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">66</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pathB</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path2</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">68</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"chunk_id"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">df3</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dotdotdot</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">74</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_map</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">df3</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">row</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#future.apply::future_lapply(1:nrow(df3), function(row) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#lapply(1:nrow(df3), function(row) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">78</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">df3</span><span class="paren">[</span><span class="identifier">row</span>, <span class="identifier">chunk_id</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">80</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data1</span> <span class="operator">=</span> <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df1</span>, <span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">81</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data2</span> <span class="operator">=</span> <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df2</span>, <span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">83</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">data1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">84</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">data2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">86</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">setkeyv</span><span class="paren">(</span><span class="identifier">data2</span>, <span class="identifier">by.y</span><span class="paren">[</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">by.y</span><span class="paren">)</span><span class="operator">-</span><span class="number">2</span><span class="operator">+</span><span class="number">1</span><span class="paren">)</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">by.y</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">88</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdot</span><span class="operator">$</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">data1</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">89</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdot</span><span class="operator">$</span><span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">data2</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">90</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data3</span> <span class="operator">=</span> <span class="identifier">pryr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">do_call</span><span class="paren">(</span><span class="identifier">foverlaps</span>, <span class="identifier">dotdotdot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">91</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">data1</span><span class="paren">)</span>; <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">data2</span><span class="paren">)</span>; <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">92</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">outdir</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">93</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">data3</span>, <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"{outdir}/{chunk_id}"</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">94</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">data3</span><span class="paren">)</span>; <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">95</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">97</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">99</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"foverlaps.disk.frame: only merge_by_chunk_id = TRUE is implemented"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/overwrite_check.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Check if the outdir exists or not</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' If the overwrite is TRUE then the folder will be deleted, otherwise the folder will be created.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite TRUE or FALSE if `outdir`` exists and overwrite = FALSE then throw an error</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tf = tempfile()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' overwrite_check(tf, overwrite = FALSE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' overwrite_check(tf, overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' fs::dir_delete(tf)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">overwrite_check</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">##browser</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">745<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">20</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"outdir is NULL; no overwrite check is performed"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">21</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="literal">NULL</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">745<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">overwrite</span> <span class="operator">&amp;</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">375<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is_disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"The directory is {outdir} is not a disk.frame folder. Execution has stopped to prevent accidental deletion of potentially important files"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">374<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">all</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">!=</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">tryCatch</span><span class="paren">(</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">error</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">32</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"Failed to delete the directory {outdir} in preparation for overwrite, this could be due to many reason and may be a genuine bug. Firstly, though, please ensure you do not have the folder open by Explorer (Windows) or other file management systems"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">374<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">370<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">overwrite</span> <span class="operator">==</span> <span class="literal">FALSE</span> <span class="operator">&amp;</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"overwrite  = FALSE and outdir '{outdir}' already exists"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">368<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Create a disk.frame from a folder</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param path The path to store the output file or to a directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param backend The only available backend is fst at the moment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' path = file.path(tempdir(),"cars")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' as.disk.frame(cars, outdir=path, overwrite = TRUE, nchunks = 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df = disk.frame(path)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' head(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">backend</span> <span class="operator">=</span> <span class="string">"fst"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># only fst backend is implemented at the moment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">backend</span> <span class="operator">==</span> <span class="string">"fst"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">disk.frame_folder</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">20</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">21</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">disk.frame_fst</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if neither exists then create it</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">24</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">25</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Add metadata to the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom jsonlite toJSON fromJSON</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_create file_create</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardkey the shard key</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardchunks The number of chunks to shard to. Sometimes the number of actual file chunks is different to the number of intended chunks. In this case the shardchunks is the intended number</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... any other metadata the user wishes to keep.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # adding some useless metadata to the repo</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' add_meta(cars.df, useless = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">add_meta</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks.disk.frame</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="string">""</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="operator">-</span><span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">50</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># create the metadata folder if not present</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="string">".metadata"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">json_path</span> <span class="operator">=</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_create</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="string">".metadata"</span>, <span class="string">"meta.json"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">57</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">filesize</span> <span class="operator">=</span> <span class="identifier">file.size</span><span class="paren">(</span><span class="string">"meta.json"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">meta_out</span> <span class="operator">=</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">filesize</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># the file is empty</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span> <span class="operator">=</span> <span class="identifier">jsonlite</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">toJSON</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">c</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">list</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardkey</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">shardchunks</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">71</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span> <span class="operator">=</span> <span class="identifier">jsonlite</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fromJSON</span><span class="paren">(</span><span class="identifier">json_path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span><span class="operator">$</span><span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">73</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span><span class="operator">$</span><span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardkey</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">74</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span><span class="operator">$</span><span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">shardchunks</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">75</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">meta_out</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">meta_out</span>, <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cat</span><span class="paren">(</span><span class="identifier">meta_out</span>, <span class="identifier">file</span> <span class="operator">=</span> <span class="identifier">json_path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">330<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Create a disk.frame pointed to a folder</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname disk.frame_fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">disk.frame_folder</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span><span class="operator">$</span><span class="identifier">files</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span><span class="operator">$</span><span class="identifier">files_short</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">path</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"backend"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"fst"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"disk.frame"</span>, <span class="string">"disk.frame.folder"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#attr(df, "metadata") &lt;- sapply(files,function(file1) fst::fst.metadata(file1))</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"performing"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"none"</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">467<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param path The path to store the output file or to a directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">disk.frame_fst</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">101</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">102</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"metadata"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fst.metadata</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">103</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">path</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">104</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"backend"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"fst"</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">105</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"disk.frame"</span>, <span class="string">"disk.frame.file"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">106</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"performing"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"none"</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">107</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">prepare_dir.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">path</span>, <span class="identifier">clean</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">111</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fpath</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">112</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fpath2</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">fpath</span>,<span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">113</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">fpath2</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">114</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dir.create</span><span class="paren">(</span><span class="identifier">fpath2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">115</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">clean</span><span class="paren">)</span> <span class="paren">{</span>    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">116</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">fpath2</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">unlink</span>, <span class="identifier">recursive</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">force</span>  <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">118</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fpath2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' The readiness of a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Sometimes a disk.frame may be in use and this check whether it is ready from a long running non-blocking process.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># TODO </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is_ready</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">96<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">129</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"is_ready"</span><span class="paren">)</span>  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">status</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">133</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"status"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">status.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">137</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">perf</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"performing"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">138</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">perf</span> <span class="operator">==</span> <span class="string">"none"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">139</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">nc</span> <span class="operator">=</span> <span class="identifier">nchunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">skip.ready.check</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">140</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">status</span> <span class="operator">=</span> <span class="string">"at rest"</span>, <span class="identifier">nchunk</span> <span class="operator">=</span> <span class="identifier">nc</span>, <span class="identifier">nchunk_ready</span> <span class="operator">=</span> <span class="identifier">nc</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">141</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">perf</span> <span class="operator">==</span> <span class="string">"hard_group_by"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">142</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fpath</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"parent"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">143</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ndf</span> <span class="operator">=</span> <span class="identifier">nchunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">skip.ready.check</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">144</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">fpath</span>, <span class="string">".performing"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">145</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">status</span> <span class="operator">=</span> <span class="string">"hard group by"</span>, <span class="identifier">nchunk</span> <span class="operator">=</span> <span class="identifier">ndf</span>, <span class="identifier">nchunk_ready</span> <span class="operator">=</span> <span class="number">0</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">146</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">fpath</span>, <span class="string">".performing"</span>, <span class="string">"outchunks"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">147</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">l</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">fpath</span>, <span class="string">".performing"</span>, <span class="string">"outchunks"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">148</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">l</span> <span class="operator">==</span> <span class="identifier">ndf</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">149</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"performing"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="string">"none"</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">150</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">return</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">status</span> <span class="operator">=</span><span class="string">"none"</span>, <span class="identifier">nchunk</span> <span class="operator">=</span> <span class="identifier">ndf</span>, <span class="identifier">nchunk_read</span> <span class="operator">=</span> <span class="identifier">ndf</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">152</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">status</span> <span class="operator">=</span> <span class="string">"hard group by"</span>, <span class="identifier">nchunk</span> <span class="operator">=</span> <span class="identifier">ndf</span>, <span class="identifier">nchunk_ready</span> <span class="operator">=</span> <span class="identifier">l</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">153</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">154</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">155</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">status</span> <span class="operator">=</span> <span class="string">"unknown"</span>, <span class="identifier">nchunk</span> <span class="operator">=</span> <span class="literal">NA</span>, <span class="identifier">nchunk_ready</span> <span class="operator">=</span> <span class="literal">NA</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is_ready.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">160</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">sts</span> <span class="operator">=</span> <span class="identifier">status</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">161</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">sts</span><span class="operator">$</span><span class="identifier">status</span> <span class="operator">==</span> <span class="string">"none"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">162</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">164</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">168</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Is the disk.frame a single-file or a folder</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Checks if the df is a single-file based disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">171</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">172</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param check.consistency check for consistency e.g. if it's actually a file</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">173</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">174</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.file.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">check.consistency</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">175</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">check.consistency</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">176</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fpath</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">177</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">fpath</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">fpath</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">178</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">180</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">181</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">183</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="string">"disk.frame.file"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">185</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">186</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname is.file.disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">187</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is.dir.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">check.consistency</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">189</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="operator">!</span><span class="identifier">is.file.disk.frame</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">check.consistency</span> <span class="operator">=</span> <span class="identifier">check.consistency</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">190</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">191</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Head and tail of the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">193</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">194</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param n number of rows to include</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">195</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to base::head or base::tail</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">197</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">198</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils head</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">199</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_exists</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">201</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname head_tail</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">202</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">203</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">204</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' head(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">205</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tail(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">206</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">208</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">head.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">n</span> <span class="operator">=</span> <span class="number">6L</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">210</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is_ready</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">211</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path1</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">212</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cmds</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">213</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">214</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">215</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">head</span><span class="paren">(</span><span class="identifier">play</span><span class="paren">(</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">path2</span>, <span class="identifier">from</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">to</span> <span class="operator">=</span> <span class="identifier">n</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">cmds</span><span class="paren">)</span>, <span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">n</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">216</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">217</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"dir {path1} does not exist"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">218</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">219</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">220</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">221</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">222</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">223</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils tail</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">224</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname head_tail</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">225</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">tail.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">n</span> <span class="operator">=</span> <span class="number">6L</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">226</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is_ready</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">227</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path1</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">228</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cmds</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">229</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">230</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">231</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">&lt;-</span> <span class="identifier">path2</span><span class="paren">[</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">path2</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">232</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tail</span><span class="paren">(</span><span class="identifier">play</span><span class="paren">(</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">path2</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">cmds</span><span class="paren">)</span>, <span class="identifier">n</span> <span class="operator">=</span> <span class="identifier">n</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">233</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">234</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"dir {path1} does not exist"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">236</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/csv2disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert CSV file(s) to disk.frame format</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_delete</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param infile The input CSV file or files</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The directory to output the disk.frame to</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param inmapfn A function to be applied to the chunk read in from CSV before the chunk is being written out. Commonly used to perform simple transformations. Defaults to the identity function (ie. no transformation)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks Number of chunks to output</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param in_chunk_size When reading in the file, how many lines to read in at once. This is different to nchunks which controls how many chunks are output</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby The column(s) to shard the data by. For example suppose `shardby = c("col1","col2")`  then every row where the values `col1` and `col2` are the same will end up in the same chunk; this will allow merging by `col1` and `col2` to be more efficient</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress For fst backends it's a number between 0 and 100 where 100 is the highest compression ratio.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite Whether to overwrite the existing directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param header Whether the files have header. Defaults to TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .progress A logical, for whether or not to print a progress bar for multiprocess, multisession, and multicore plans. From {furrr}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to data.table::fread, disk.frame::as.disk.frame, disk.frame::shard</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tmpfile = tempfile()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' write.csv(cars, tmpfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tmpdf = tempfile(fileext = ".df")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df = csv_to_disk.frame(tmpfile, outdir = tmpdf, overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' fs::file_delete(tmpfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">csv_to_disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">inmapfn</span> <span class="operator">=</span> <span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">I</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">file.size</span><span class="paren">(</span><span class="identifier">infile</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">in_chunk_size</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">compress</span><span class="operator">=</span><span class="number">50</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">header</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># reading multiple files</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">infile</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dotdotdot</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">origarg</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="identifier">inmapfn</span> <span class="operator">=</span> <span class="identifier">inmapfn</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">in_chunk_size</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">36</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                   <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">header</span> <span class="operator">=</span> <span class="identifier">header</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dotdotdotorigarg</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">dotdotdot</span>, <span class="identifier">origarg</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">pt</span> <span class="operator">&lt;-</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">40</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">.progress</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="string">"-- Converting CSVs to disk.frame --"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"Converting {length(infile)} CSVs to a {nchunks} disk.frame each consisting of {nchunks} (Stage 1 of 2):"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">outdf_tmp</span> <span class="operator">=</span> <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_imap</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdotorigarg1</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">dotdotdotorigarg</span>, <span class="identifier">list</span><span class="paren">(</span><span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tempdir</span><span class="paren">(</span><span class="paren">)</span>, <span class="identifier">.y</span><span class="paren">)</span>, <span class="identifier">infile</span><span class="operator">=</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">49</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">pryr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">do_call</span><span class="paren">(</span><span class="identifier">csv_to_disk.frame</span>, <span class="identifier">dotdotdotorigarg1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">50</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="identifier">.progress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">.progress</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste</span><span class="paren">(</span><span class="string">"Stage 1 or 2 took:"</span>, <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">54</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="string">" "</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">57</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">message</span><span class="paren">(</span><span class="string">"Row-binding the {nchunks} disk.frames together to form one large disk.frame (Stage 2 of 2):"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">58</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">message</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"Creating the disk.frame at {outdir}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">pt2</span> <span class="operator">&lt;-</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">60</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">outdf</span> <span class="operator">=</span> <span class="identifier">rbindlist.disk.frame</span><span class="paren">(</span><span class="identifier">outdf_tmp</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="identifier">.progress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">.progress</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste</span><span class="paren">(</span><span class="string">"Stage 2 or 2 took:"</span>, <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt2</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="string">" ----------------------------------------------------- "</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">66</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste</span><span class="paren">(</span><span class="string">"Stage 1 &amp; 2 in total took:"</span>, <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">69</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">outdf</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span> <span class="comment"># reading one file</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">71</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">l</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">73</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">in_chunk_size</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">as.disk.frame</span><span class="paren">(</span><span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="identifier">header</span><span class="operator">=</span><span class="identifier">header</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">outdir</span>, <span class="identifier">compress</span><span class="operator">=</span><span class="identifier">compress</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">75</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">return</span><span class="paren">(</span><span class="identifier">a</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">77</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">outdf</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">78</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">i</span> <span class="operator">&lt;-</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">79</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">tmpdir1</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">pattern</span><span class="operator">=</span><span class="string">"df_tmp"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">80</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">tmpdir1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">82</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">done</span> <span class="operator">=</span> <span class="literal">FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">83</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">skiprows</span> <span class="operator">=</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">84</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">column_names</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">85</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">while</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">done</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">86</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">column_names</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">87</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">88</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">89</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>,<span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">90</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">column_names</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">tmpdt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">92</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">ddd</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">93</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="keyword">if</span> <span class="paren">(</span><span class="string">"col.names"</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">ddd</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">94</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">95</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">96</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">97</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">header</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">99</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">100</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">101</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">102</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">header</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">col.names</span> <span class="operator">=</span> <span class="identifier">column_names</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">106</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">i</span> <span class="operator">&lt;-</span> <span class="identifier">i</span> <span class="operator">+</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">107</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">skiprows</span> <span class="operator">=</span> <span class="identifier">skiprows</span> <span class="operator">+</span> <span class="identifier">in_chunk_size</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="comment"># skips the header as well but only at the first chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">109</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">i</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">&amp;</span> <span class="identifier">header</span>, <span class="number">1</span>, <span class="number">0</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">110</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">rows</span> <span class="operator">&lt;-</span> <span class="identifier">tmpdt</span><span class="paren">[</span>,<span class="identifier">.N</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">111</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">if</span><span class="paren">(</span><span class="identifier">rows</span> <span class="operator">&lt;</span> <span class="identifier">in_chunk_size</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">112</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">done</span> <span class="operator">&lt;-</span> <span class="literal">TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">115</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="comment"># add to chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">116</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">add_chunk</span><span class="paren">(</span><span class="identifier">outdf</span>, <span class="identifier">tmpdt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">117</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">tmpdt</span><span class="paren">)</span>; <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">120</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"read {in_chunk_size*(i-1) + rows} rows from {infile}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">122</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># remove the files</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">123</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">tmpdir1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span> <span class="comment"># so shard by some element</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">126</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">in_chunk_size</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">127</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">shard</span><span class="paren">(</span><span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="identifier">header</span><span class="operator">=</span><span class="identifier">header</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>,<span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">128</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">129</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">i</span> <span class="operator">&lt;-</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">130</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">tmpdir1</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">pattern</span><span class="operator">=</span><span class="string">"df_tmp"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">131</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">tmpdir1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#message(tmpdir1)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">134</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">done</span> <span class="operator">=</span> <span class="literal">FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">135</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">skiprows</span> <span class="operator">=</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">136</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">column_names</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">137</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">while</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">done</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">138</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">column_names</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">139</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">140</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">141</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>,<span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">142</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">column_names</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">tmpdt</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">144</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">ddd</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">145</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="keyword">if</span> <span class="paren">(</span><span class="string">"col.names"</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">ddd</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">146</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">147</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">148</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">149</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">header</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">151</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">tmpdt</span> <span class="operator">=</span> <span class="identifier">inmapfn</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">152</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">infile</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">153</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">skip</span> <span class="operator">=</span> <span class="identifier">skiprows</span>, <span class="identifier">nrows</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">154</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">header</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">col.names</span> <span class="operator">=</span> <span class="identifier">column_names</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">158</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">i</span> <span class="operator">&lt;-</span> <span class="identifier">i</span> <span class="operator">+</span> <span class="number">1</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">159</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">skiprows</span> <span class="operator">=</span> <span class="identifier">skiprows</span> <span class="operator">+</span> <span class="identifier">in_chunk_size</span> <span class="operator">+</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">160</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="comment"># skips the header as well but only at the first chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">161</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">ifelse</span><span class="paren">(</span><span class="identifier">i</span> <span class="operator">==</span> <span class="number">1</span> <span class="operator">&amp;</span> <span class="identifier">header</span>, <span class="number">1</span>, <span class="number">0</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">162</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">rows</span> <span class="operator">&lt;-</span> <span class="identifier">tmpdt</span><span class="paren">[</span>,<span class="identifier">.N</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">163</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">if</span><span class="paren">(</span><span class="identifier">rows</span> <span class="operator">&lt;</span> <span class="identifier">in_chunk_size</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">164</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">done</span> <span class="operator">&lt;-</span> <span class="literal">TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">167</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">tmp.disk.frame</span> <span class="operator">=</span> <span class="identifier">shard</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">168</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">tmpdt</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">169</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">170</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">171</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir1</span>,<span class="identifier">i</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">172</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">173</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>,<span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">174</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">tmpdt</span><span class="paren">)</span>; <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">176</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">177</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"read {in_chunk_size*(i-1) + rows} rows from {infile}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">178</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># do not run this in parallel as the level above this is likely in parallel</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">180</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># ZJ:</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">181</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">system.time</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">182</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">fnl_out</span> <span class="operator">&lt;-</span> </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">183</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">rbindlist.disk.frame</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">184</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">lapply</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">185</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                <span class="identifier">list.files</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">186</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="identifier">tmpdir1</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">disk.frame</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">187</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">              <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">parallel</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">189</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># remove the files</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">190</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">tmpdir1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">191</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">193</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">194</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">nchunks</span><span class="operator">=</span><span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">195</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">196</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">197</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/sas2disk_frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert a SAS file (.sas7bdat) format to CSV or disk.frame by chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param infile the SAS7BDAT file</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param chunk which convert of nchunks to convert</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param sas2csvpath path to sas2csv.exe</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param sep separater of the CSV file, defaults to |</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">sas_to_csv</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="identifier">chunk</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_size</span><span class="paren">(</span><span class="identifier">infile</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">sas2csvpath</span> <span class="operator">=</span> <span class="string">"sas2csv/sas2csv.exe"</span>, <span class="identifier">sep</span><span class="operator">=</span><span class="string">"|"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">9</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">sas2csvpath</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">10</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"You must have the sas2csv.exe installed. Only Windows is supported at the moment. Please contact the author"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">12</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">sasfile</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">'"{infile}"'</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">13</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="string">"outcsv"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">14</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="string">"outcsv"</span>, <span class="identifier">chunk</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">15</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">options</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"-o outcsv/{chunk}/ -d {sep} -c -n {nchunks} -k {paste(chunk-1,collapse = ' ')} -m"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">17</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cmd</span> <span class="operator">=</span> <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">sas2csvpath</span>, <span class="identifier">sasfile</span>, <span class="identifier">options</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">18</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">system</span><span class="paren">(</span><span class="identifier">cmd</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert a SAS file (.sas7bdat format) to disk.frame via CSVs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param inpath input SAS7BDAT file</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outpath output disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param sep separater of the intermediate CSV file, defaults to |</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param remove_csv TRUE/FALSE. Remove the intermediate CSV after usage?</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future %&lt;-%</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">sas_to_disk.frame</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">inpath</span>, <span class="identifier">outpath</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">inpath</span><span class="paren">)</span>, <span class="identifier">sas2csvpath</span> <span class="operator">=</span> <span class="string">"sas2csv/sas2csv.exe"</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"|"</span>, <span class="identifier">remove_csv</span> <span class="operator">=</span> <span class="literal">T</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outpath</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nchunks</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ready</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="literal">F</span>, <span class="identifier">nchunks</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">files</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># ready = c(rep(T, 96), rep(F, 4))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">extracting</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="literal">F</span>, <span class="identifier">nchunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outpath</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">36</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="string">"outcsv"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">38</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="string">"this program converts SAS datasets to CSV first before conversion to disk.frame."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">print</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"the intermediate CSVs are here: {file.path(getwd(), 'outcsv')}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">while</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">ready</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">42</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">done1</span> <span class="operator">=</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">extracting_jobs</span> <span class="operator">=</span> <span class="literal">F</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">for</span><span class="paren">(</span><span class="identifier">w</span> <span class="keyword">in</span> <span class="identifier">which</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">ready</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">incsv</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="string">"outcsv"</span>, <span class="identifier">w</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="string">"_"</span>, <span class="identifier">w</span><span class="operator">-</span><span class="number">1</span>,<span class="string">".csv"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">incsv</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">done1</span> <span class="operator">=</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ready</span><span class="paren">[</span><span class="identifier">w</span><span class="paren">]</span> <span class="operator">=</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">49</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ok</span> <span class="operator">%&lt;-%</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">50</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fread</span><span class="paren">(</span><span class="identifier">incsv</span><span class="paren">)</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outpath</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">w</span>,<span class="string">".fst.tmp"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">51</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">file.rename</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outpath</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">w</span>,<span class="string">".fst.tmp"</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outpath</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">w</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">if</span><span class="paren">(</span><span class="identifier">remove_csv</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">            <span class="identifier">file.remove</span><span class="paren">(</span><span class="identifier">incsv</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">57</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">print</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"converting: {w} of {nchunks}; time: {Sys.time()}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">58</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">extracting_jobs</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">extracting</span><span class="paren">[</span><span class="identifier">w</span><span class="paren">]</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">60</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">done1</span> <span class="operator">=</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">61</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">extracting_jobs</span> <span class="operator">=</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">extracting</span><span class="paren">[</span><span class="identifier">w</span><span class="paren">]</span> <span class="operator">&lt;-</span> <span class="literal">T</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">63</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">ok</span> <span class="operator">%&lt;-%</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="identifier">sas_to_csv</span><span class="paren">(</span><span class="identifier">inpath</span>, <span class="identifier">w</span>, <span class="identifier">nchunks</span>, <span class="identifier">sas2csvpath</span>, <span class="identifier">sep</span> <span class="operator">=</span> <span class="identifier">sep</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">66</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">print</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"extracting: {w} of {nchunks}; time: {Sys.time()}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">done1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">71</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">print</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"didn't get any work: {Sys.time()}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">Sys.sleep</span><span class="paren">(</span><span class="number">18</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/write_disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Write disk.frame to disk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Write a data.frame/disk.frame to a disk.frame location. If df is a</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' data.frame, then df must contain the column .out.disk.frame.id. This is</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' intended to be a low-level version of writing disk.frames. Using the</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' as.disk.frame function is recommended for most cases</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir output directory for the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby the columns to shard by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress compression ratio for fst files</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to map.disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst fs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # write out a lazy disk.frame to disk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2.df = write_disk.frame(map(cars.df, ~.x[1,]), overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">write_disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks.disk.frame</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">shardby</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="number">50</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">284<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">284<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"outdir must not be NULL"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">284<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is_disk.frame</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="identifier">df</span>, <span class="operator">~</span><span class="identifier">.x</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span><span class="paren">[</span>,<span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">1353<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">.SD</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">1353<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">.SD</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">.BY</span>, <span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">1353<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">1353<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">.out.disk.frame.id</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"write_disk.frame error: df must be a disk.frame or data.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname write_disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">output_disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">warning</span><span class="paren">(</span><span class="string">"output_disk.frame is DEPRECATED. Use write_disk.frame istead"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">54</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write_disk.frame</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/zip_to_disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `zip_to_disk.frame` is used to read and convert every CSV file within the zip</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' file to disk.frame format</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param zipfile The zipfile</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The output directory for disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to fread</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param validation.check should the function perform a check at the end to check for validity of output. It can detect issues with conversion</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst fs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future.apply future_lapply</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils unzip</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return a list of disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # create a zip file containing a csv</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' csvfile = tempfile(fileext = ".csv")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' write.csv(cars, csvfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' zipfile = tempfile(fileext = ".zip")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' zip(zipfile, csvfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # read every file and convert it to a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' zip.df = zip_to_disk.frame(zipfile, tempfile(fileext = ".df"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # there is only one csv file so it return a list of one disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' zip.df[[1]]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' unlink(csvfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' unlink(zipfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(zip.df[[1]])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># TODO do NSE better here. add all the options of fread into the ... as future may not be able to deal with it</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">zip_to_disk.frame</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">outdir</span>, <span class="keyword">...</span>, <span class="identifier">validation.check</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">unzip</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">list</span><span class="operator">=</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">tmpdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"tmp_zip2csv"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dotdotdots</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dfs</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="identifier">files</span><span class="operator">$</span><span class="identifier">Name</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">fn</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#dfs = lapply(files$Name, function(fn) {</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">outdfpath</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">fn</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdfpath</span>, <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">unzip</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">fn</span>, <span class="identifier">exdir</span> <span class="operator">=</span> <span class="identifier">tmpdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># lift the domain of csv_to_disk.frame so it accepts a list</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">cl</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">lift</span><span class="paren">(</span><span class="identifier">csv_to_disk.frame</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">50</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ok</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">51</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">list</span><span class="paren">(</span><span class="identifier">infile</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir</span>, <span class="identifier">fn</span><span class="paren">)</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdfpath</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdots</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#csv_to_disk.frame(, outdfpath, overwrite = overwrite, ...)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">cl</span><span class="paren">(</span><span class="identifier">ok</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">58</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dfs</span>  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `validate_zip_to_disk.frame` is used to validate and auto-correct read and convert every single file within the zip file to df format</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils unzip</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table timetaken fread</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname zip_to_disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">validate_zip_to_disk.frame</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">outdir</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">69</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">unzip</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">list</span><span class="operator">=</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">71</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"The output directory {outdir} does not exist.\n Nothing to validate."</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">75</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">tmpdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">pattern</span> <span class="operator">=</span> <span class="string">"tmp_zip2csv"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># check if files are ok</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">78</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">system.time</span><span class="paren">(</span><span class="identifier">lapply</span><span class="paren">(</span><span class="identifier">files</span><span class="operator">$</span><span class="identifier">Name</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">fn</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">79</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">message</span><span class="paren">(</span><span class="identifier">fn</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">80</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">out_fst_file</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">fn</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">82</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">out_fst_file</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">83</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">tryCatch</span><span class="paren">(</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># the output file already exists</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># read it and if it errors then the file might be corrupted, so </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment"># read it again and write again</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">87</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">88</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">out_fst_file</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">89</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"checking(read): "</span>, <span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>; <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">90</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">error</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">91</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">92</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">93</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">unzip</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">fn</span>, <span class="identifier">exdir</span> <span class="operator">=</span> <span class="identifier">tmpdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">94</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"unzip: "</span>, <span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>; <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">95</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">fread</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir</span>, <span class="identifier">fn</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">out_fst_file</span>,<span class="number">100</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">96</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"read: "</span>, <span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">97</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">unlink</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir</span>, <span class="identifier">fn</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">98</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">100</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="string">"output already exists"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">101</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="literal">NULL</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">102</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># if the output file doesn't exists then the process might have failed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">104</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># re do again</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">105</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">106</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">unzip</span><span class="paren">(</span><span class="identifier">zipfile</span>, <span class="identifier">files</span> <span class="operator">=</span> <span class="identifier">fn</span>, <span class="identifier">exdir</span> <span class="operator">=</span> <span class="identifier">tmpdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">107</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"unzip: "</span>, <span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>; <span class="identifier">pt</span> <span class="operator">=</span> <span class="identifier">proc.time</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">108</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">fread</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir</span>, <span class="identifier">fn</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">out_fst_file</span>,<span class="number">100</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">109</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">paste0</span><span class="paren">(</span><span class="string">"read: "</span>, <span class="identifier">timetaken</span><span class="paren">(</span><span class="identifier">pt</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">110</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">unlink</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">tmpdir</span>, <span class="identifier">fn</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">111</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">113</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span><span class="paren">)</span> <span class="comment"># 507 econds</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/collect.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Bring the disk.frame into R as data.table/data.frame or as a list </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param parallel if TRUE the collection is performed in parallel. By default</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   if there are delayed/lazy steps then it will be parallel, otherwise it will</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   not be in parallel. This is because parallel requires transferring data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   from background R session to the current R session and if there is no</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   computation then it's better to avoid transferring data between session,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   hence parallel = FALSE is a better choice</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table data.table as.data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom furrr future_map_dfr future_options</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr map_dfr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr collect select mutate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return data.frame/data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # use collect to bring the data into RAM as a data.table/data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname collect</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">collect.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span>, <span class="identifier">parallel</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>,<span class="string">"lazyfn"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#cids = get_chunk_ids(x, full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">65<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cids</span> <span class="operator">=</span> <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">65<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">parallel</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#furrr::future_map_dfr(cids, ~get_chunk(x, .x, full.names = TRUE), .options = furrr::future_options(packages = "disk.frame"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#furrr::future_map_dfr(cids, ~disk.frame::get_chunk(x, .x, full.names = TRUE))</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">17<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_map_dfr</span><span class="paren">(</span><span class="identifier">cids</span>, <span class="operator">~</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#purrr::map_dfr(cids, ~get_chunk(x, .x, full.names = TRUE))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#future.apply::future_lapply(chunk_ids, function(.x) disk.frame::get_chunk(x, .x))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#lapply(chunk_ids, function(chunk) get_chunk(x, chunk)) %&gt;% rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">45<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">cids</span>, <span class="operator">~</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">.x</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param simplify Should the result be simplified to array</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname collect</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return list</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # returns the result as a list</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect_list(map(cars.df, ~1))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">collect_list</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">simplify</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">parallel</span> <span class="operator">=</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>,<span class="string">"lazyfn"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">57</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">58</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">&lt;-</span> <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">parallel</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#res = furrr::future_map(1:nchunks(x), ~get_chunk(x, .x))</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">61</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="operator">~</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">67</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">simplify</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">68</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">simplify2array</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">73</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">list</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/move_to.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Move or copy a disk.frame to another location</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df The disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The new location</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param copy Merely copy and not move</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... NOT USED</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars_copy.df = copy_df_to(cars.df, outdir = tempfile(fileext=".df"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2.df = move_to(cars.df, outdir = tempfile(fileext=".df"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars_copy.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">move_to</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span>, <span class="keyword">...</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">21</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">22</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">25</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">copy</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="literal">TRUE</span>, <span class="literal">FALSE</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">26</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"disk.frame::move_to ERROR: copy argument must be TRUE or FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">## copy all files over</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">listfiles</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">shortlistfiles</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">32</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">walk2</span><span class="paren">(</span><span class="identifier">listfiles</span>, <span class="identifier">shortlistfiles</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">copy</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_copy</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">36</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_move</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">## copy .metadata over</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">metadata_path</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="string">".metadata"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">listfiles</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">metadata_path</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">shortlistfiles</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">metadata_path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">walk2</span><span class="paren">(</span><span class="identifier">listfiles</span>, <span class="identifier">shortlistfiles</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">copy</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">49</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_copy</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span>, <span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">51</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_move</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="string">".metadata"</span>, <span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">copy</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">56</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">delete</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname move_to</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">copy_df_to</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">move_to</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span>, <span class="keyword">...</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/recommend_nchunks.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Recommend number of chunks based on input size</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Computes the recommended number of chunks to break a data.frame into. It can</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' accept filesizes in bytes (as integer) or a data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame or the file size in bytes of a CSV file holding the data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param type only = "csv" is supported. It indicates the file type corresponding to file size `df`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param minchunks the minimum number of chunks. Defaults to the number of CPU cores (without hyper-threading)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param conservatism a multiplier to the recommended number of chunks. The more chunks the smaller the chunk size and more likely that each chunk can fit into RAM</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr object_size</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom utils memory.limit</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom benchmarkme get_ram</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # recommend nchunks based on data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' recommend_nchunks(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # recommend nchunks based on file size ONLY CSV is implemented at the moment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' recommend_nchunks(1024^3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">recommend_nchunks</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">type</span> <span class="operator">=</span> <span class="string">"csv"</span>, <span class="identifier">minchunks</span> <span class="operator">=</span> <span class="identifier">parallel</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">detectCores</span><span class="paren">(</span><span class="identifier">logical</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>, <span class="identifier">conservatism</span> <span class="operator">=</span> <span class="number">2</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dfsize</span> <span class="operator">=</span> <span class="number">0</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># the df's size in gigabytes</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">22<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dfsize</span> <span class="operator">=</span> <span class="identifier">as.numeric</span><span class="paren">(</span><span class="identifier">pryr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">object_size</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">type</span> <span class="operator">==</span> <span class="string">"csv"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># assume that df is the estimated number of bytes of the data</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dfsize</span> <span class="operator">=</span> <span class="identifier">df</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">28</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">dfsize</span> <span class="operator">=</span> <span class="identifier">df</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># the amount of memory available in gigabytes</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">Sys.info</span><span class="paren">(</span><span class="paren">)</span><span class="paren">[</span><span class="paren">[</span><span class="string">"sysname"</span><span class="paren">]</span><span class="paren">]</span> <span class="operator">==</span> <span class="string">"Windows"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ml</span> <span class="operator">=</span> <span class="identifier">memory.limit</span><span class="paren">(</span><span class="paren">)</span> <span class="operator">/</span> <span class="number">1024</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#} else if (Sys.info()[["sysname"]] %in% c("Linux","Darwin")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#ml = as.numeric(system('grep MemTotal /proc/meminfo', ignore.stdout = TRUE) / 1024)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">38</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ml</span> <span class="operator">=</span> <span class="identifier">benchmarkme</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_ram</span><span class="paren">(</span><span class="paren">)</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span><span class="operator">/</span><span class="number">1024</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">ml</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">42</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"memory size not detected, Assumming you have at least 16G of RAM"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ml</span> <span class="operator">=</span> <span class="number">16</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># assume at least 1G of RAM</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ml</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ml</span>, <span class="number">1</span>, <span class="identifier">na.rm</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># the number physical cores not counting hyper threaded ones as 2; they are counted as 1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">nc</span> <span class="operator">=</span> <span class="identifier">parallel</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">detectCores</span><span class="paren">(</span><span class="identifier">logical</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">28<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">max</span><span class="paren">(</span><span class="identifier">round</span><span class="paren">(</span><span class="identifier">dfsize</span><span class="operator">/</span><span class="identifier">ml</span><span class="operator">*</span><span class="identifier">nc</span><span class="paren">)</span><span class="operator">*</span><span class="identifier">nc</span><span class="operator">*</span><span class="identifier">conservatism</span>, <span class="identifier">minchunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/ncol-nrow.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Number of rows or columns</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to base::nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname ncol_nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return total number of column and rows</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' ncol(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nrow(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nrow</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>,<span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">341<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"nrow"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname ncol_nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nrow.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">314<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname ncol_nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nrow.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is_ready</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path1</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">dir.exists</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">path2</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="number">0</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmpfstmeta</span> <span class="operator">=</span> <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fst.metadata</span><span class="paren">(</span><span class="identifier">path2</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="string">"nrOfRows"</span> <span class="operator">%in%</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">tmpfstmeta</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">path2</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">p2</span><span class="paren">)</span> <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fst.metadata</span><span class="paren">(</span><span class="identifier">p2</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">nrOfRows</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">40</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">path2</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">p2</span><span class="paren">)</span> <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fst.metadata</span><span class="paren">(</span><span class="identifier">p2</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">NrOfRows</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#return(fst::fst.metadata(path1)$NrOfRows)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"nrow error: directory {} does not exist"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname ncol_nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">ncol</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"ncol"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname ncol_nrow</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">ncol.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">11<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">length</span><span class="paren">(</span><span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">ncol.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">ncol</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/get_chunk.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Obtain one chunk by chunk id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param n the chunk id. If numeric then matches by number, if character then returns the chunk with the same name as n</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param keep the columns to keep</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param full.names whether n is the full path to the chunks or just a relative path file name. Ignored if n is numeric</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to fst::read_fst or whichever read function is used in the backend</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars, nchunks = 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(cars.df, 1)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(cars.df, 2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(cars.df, 1, keep = "speed")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # if full.names = TRUE then the full path to the chunk need to be provided</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk(cars.df, file.path(attr(cars.df, "path"), "1.fst"), full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">get_chunk</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"get_chunk"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname get_chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fst read_fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">get_chunk.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">n</span>, <span class="identifier">keep</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep1</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"keep"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cmds</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"lazyfn"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">filename</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span> <span class="operator">==</span> <span class="string">"closure"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">keep1</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">keep1</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">keep1</span>, <span class="identifier">keep</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">40</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">all</span><span class="paren">(</span><span class="identifier">keep</span> <span class="operator">%in%</span> <span class="identifier">keep1</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"some of the variables specified in keep = {keep} is not available"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">keep1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">n</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#filename = list.files(path, full.names = TRUE)[n]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">356<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">n</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">593<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">full.names</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">566<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">n</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">27<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">n</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if the file you are looking for don't exist</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_exists</span><span class="paren">(</span><span class="identifier">filename</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">60</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"The chunk {filename} does not exist; returning an empty data.table"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">61</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">notbl</span> <span class="operator">&lt;-</span> <span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">62</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">notbl</span>, <span class="string">"does not exist"</span><span class="paren">)</span> <span class="operator">&lt;-</span> <span class="literal">TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">63</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">notbl</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">949<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">cmds</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">67</td>
                    <td class="coverage">615<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="operator">!=</span><span class="string">"closure"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">615<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">filename</span>, <span class="identifier">columns</span> <span class="operator">=</span> <span class="identifier">keep</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span>,<span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">filename</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span>,<span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">73</td>
                    <td class="coverage">334<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">typeof</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="operator">!=</span><span class="string">"closure"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">334<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">play</span><span class="paren">(</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">filename</span>, <span class="identifier">columns</span> <span class="operator">=</span> <span class="identifier">keep</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span>,<span class="keyword">...</span><span class="paren">)</span>, <span class="identifier">cmds</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">76</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">play</span><span class="paren">(</span><span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">filename</span>, <span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span>,<span class="keyword">...</span><span class="paren">)</span>, <span class="identifier">cmds</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/map.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Apply the same function to all chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .f a function to apply to each of the chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param keep the columns to keep from the input</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param chunks The number of chunks to output</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param lazy if TRUE then do this lazily</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress 0-100 fst compression ratio</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite if TRUE removes any existing chunks in the data</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param use.names for map_dfr's call to data.table::rbindlist. See data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param fill for map_dfr's call to data.table::rbindlist. See data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param idcol for map_dfr's call to data.table::rbindlist. See data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param vars_and_pkgs variables and packages to send to a background session. This is typically automatically detected</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .progress A logical, for whether or not to print a progress bar for multiprocess, multisession, and multicore plans. From {furrr}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... for compatibility with `purrr::map`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr as_mapper map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future.apply future_lapply</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the first row of each chunk lazily</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2 = map(cars.df, function(chunk) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'  chunk[,1]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' })</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(cars2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # same as above but using purrr </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2 = map(cars.df, ~.x[1,])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(cars2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the first row of each chunk eagerly as list</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' map(cars.df, ~.x[1,], lazy = FALSE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the first row of each chunk eagerly as data.table/data.frame by row-binding</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' map_dfr(cars.df, ~.x[1,])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # lazy and delayed are just an aliases for map(..., lazy = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(lazy(cars.df, ~.x[1,]))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(delayed(cars.df, ~.x[1,]))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">115<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"map"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">54</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future getGlobalsAndPackages</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">keep</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">chunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="number">50</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">vars_and_pkgs</span> <span class="operator">=</span> <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">getGlobalsAndPackages</span><span class="paren">(</span><span class="identifier">.f</span>, <span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">parent.frame</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">140<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">.f</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as_mapper</span><span class="paren">(</span><span class="identifier">.f</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">140<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">lazy</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">72<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span>, <span class="identifier">list</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">func</span> <span class="operator">=</span> <span class="identifier">.f</span>, <span class="identifier">vars_and_pkgs</span> <span class="operator">=</span> <span class="identifier">vars_and_pkgs</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">65</td>
                    <td class="coverage">72<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">68</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is_ready</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">74</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep1</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="string">"keep"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">76</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">keep1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">81</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">82</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files_shortname</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep_future</span> <span class="operator">=</span> <span class="identifier">keep</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">cid</span> <span class="operator">=</span> <span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">88</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">files</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">ii</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">89</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#res = lapply(1:length(files), function(ii) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">309<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ds</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">cid</span><span class="paren">[</span><span class="identifier">ii</span><span class="paren">]</span>, <span class="identifier">keep</span><span class="operator">=</span><span class="identifier">keep_future</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">91</td>
                    <td class="coverage">309<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">.f</span><span class="paren">(</span><span class="identifier">ds</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">309<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">94</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"The output chunk has 0 row, therefore chunk {ii} NOT written"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">files_shortname</span><span class="paren">[</span><span class="identifier">ii</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">98</td>
                    <td class="coverage">23<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">ii</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">99</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">100</td>
                    <td class="coverage">286<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">102</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">103</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">68<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">105</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">106</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">107</td>
                    <td class="coverage">64<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">108</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">109</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">110</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">112</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">113</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .id not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">115</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map_dfr</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">116</td>
                    <td class="coverage">18<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"map_dfr"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">117</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">119</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">120</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">121</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map_dfr.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">122</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="identifier">.id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">123</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">126</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map_dfr.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="identifier">fill</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">18<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">129</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">".id is not NULL, but the parameter is not used with map_dfr.disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">130</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">131</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># TODO warn the user if outdir is map_dfr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">134</td>
                    <td class="coverage">18<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rbindlist</span><span class="paren">(</span><span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="identifier">use.names</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">fill</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="identifier">idcol</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">135</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">136</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">138</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">139</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">140</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">141</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">142</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">143</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # .x is the chunk and .y is the ID as an integer</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">144</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">145</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # lazy = TRUE support is not available at the moment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">146</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' imap(cars.df, ~.x[, id := .y], lazy = FALSE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">147</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">148</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' imap_dfr(cars.df, ~.x[, id := .y])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">149</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">150</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">151</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">152</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">153</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">154</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"imap"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">155</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">156</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">157</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">158</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">159</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">160</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">imap</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">161</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">162</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">163</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `imap.disk.frame` accepts a two argument function where the first argument is a data.frame and the </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">164</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' second is the chunk ID</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">165</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">166</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">167</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">keep</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">chunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="number">50</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">168</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">.f</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as_mapper</span><span class="paren">(</span><span class="identifier">.f</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">169</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">170</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># TODO support lazy for imap</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">171</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">lazy</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">172</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"imap.disk.frame: lazy = TRUE is not supported at this stage"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">173</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"lazyfn"</span><span class="paren">)</span>, <span class="identifier">.f</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">174</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">175</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">176</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">177</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">178</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">179</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">180</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">181</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="identifier">is_ready</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">182</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">183</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep1</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="string">"keep"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">184</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">185</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">keep</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">186</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">keep1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">187</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">188</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">189</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">190</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">&lt;-</span> <span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">191</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files_shortname</span> <span class="operator">&lt;-</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">192</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">193</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep_future</span> <span class="operator">=</span> <span class="identifier">keep</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">194</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">files</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">ii</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">195</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ds</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">ii</span>, <span class="identifier">keep</span><span class="operator">=</span><span class="identifier">keep_future</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">196</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">.f</span><span class="paren">(</span><span class="identifier">ds</span>, <span class="identifier">ii</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">197</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">198</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">files_shortname</span><span class="paren">[</span><span class="identifier">ii</span><span class="paren">]</span><span class="paren">)</span>, <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">199</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">ii</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">200</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">201</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">202</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">203</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">204</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">205</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">206</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">207</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">208</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">209</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">210</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">211</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">212</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">213</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">214</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap_dfr.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="identifier">fill</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">215</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">216</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">".id is not NULL, but the parameter is not used with map_dfr.disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">217</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">218</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">rbindlist</span><span class="paren">(</span><span class="identifier">imap.disk.frame</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="identifier">use.names</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">fill</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="identifier">idcol</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">219</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">220</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">221</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">222</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">223</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">224</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap_dfr</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">225</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"imap_dfr"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">226</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">227</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">228</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">229</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">230</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">231</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">imap_dfr.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">232</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">imap_dfr</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">.id</span> <span class="operator">=</span> <span class="identifier">.id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">233</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">234</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">235</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">236</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `lazy` is convenience function to apply `.f` to every chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">237</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">238</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">239</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">lazy</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">240</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"lazy"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">241</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">242</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">243</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">244</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">245</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">lazy.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">246</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">247</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">248</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">249</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `delayed` is an alias for lazy and is consistent with the naming in Dask and Dagger.jl</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">250</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">251</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">252</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">delayed</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">253</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"delayed"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">254</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">255</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">256</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">257</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">258</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">delayed.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">259</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">lazy</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">260</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">261</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">262</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">263</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">264</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @noRd</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">265</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">chunk_lapply</span> <span class="operator">&lt;-</span> <span class="keyword">function</span> <span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">266</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">warning</span><span class="paren">(</span><span class="string">"chunk_lapply is deprecated in favour of map.disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">267</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">map.disk.frame</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">268</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/map2.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `map` a function to two disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Perform a function on both disk.frames .x and .y, each chunk of .x and .y</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' gets run by .f(x.chunk, y.chunk)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .y a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .f a function to be called on each chunk of x and y matched by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   chunk_id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import stringr fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom purrr as_mapper map2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars2.df = map2(cars.df, cars.df, ~data.table::rbindlist(list(.x, .y)))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map2</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"map2"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map2.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">.f</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map2</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="identifier">.y</span>,<span class="identifier">.f</span>,<span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom assertthat assert_that</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map2.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">assertthat</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">assert_that</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span>, <span class="identifier">msg</span> <span class="operator">=</span> <span class="string">"running map2.disk.frame(.x,.y, ...): the .x argument must be a disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">.f</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">as_mapper</span><span class="paren">(</span><span class="identifier">.f</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># get all the chunk ids</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">xc</span> <span class="operator">=</span> <span class="identifier">data.table</span><span class="paren">(</span><span class="identifier">cid</span> <span class="operator">=</span> <span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">xc</span><span class="paren">[</span>,<span class="identifier">xid</span><span class="operator">:</span><span class="operator">=</span><span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">yc</span> <span class="operator">=</span> <span class="identifier">data.table</span><span class="paren">(</span><span class="identifier">cid</span> <span class="operator">=</span> <span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">yc</span><span class="paren">[</span>,<span class="identifier">yid</span><span class="operator">:</span><span class="operator">=</span><span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">.y</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">xyc</span> <span class="operator">=</span> <span class="identifier">merge</span><span class="paren">(</span><span class="identifier">xc</span>, <span class="identifier">yc</span>, <span class="identifier">by</span><span class="operator">=</span><span class="string">"cid"</span>, <span class="identifier">all</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">allow.cartesian</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ddd</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># apply the functions</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#future.apply::future_mapply(function(xid, yid, outid) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#mapply(function(xid, yid, outid) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">57</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_pmap</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">xyc</span><span class="operator">$</span><span class="identifier">xid</span>, <span class="identifier">xyc</span><span class="operator">$</span><span class="identifier">yid</span>, <span class="identifier">xyc</span><span class="operator">$</span><span class="identifier">cid</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">xid</span>, <span class="identifier">yid</span>, <span class="identifier">outid</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">126<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">xch</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">xid</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">126<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ych</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">.y</span>, <span class="identifier">yid</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">126<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">xych</span> <span class="operator">=</span> <span class="identifier">.f</span><span class="paren">(</span><span class="identifier">xch</span>, <span class="identifier">ych</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">126<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span><span class="paren">(</span><span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">xych</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">111<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">xych</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">outid</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">64</td>
                    <td class="coverage">15<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"one of the chunks, {xid}, is empty"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">66</td>
                    <td class="coverage">126<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#,xyc$xid, xyc$yid, xyc$cid # together with mapply</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">69</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    , <span class="identifier">.progress</span> <span class="operator">=</span> <span class="identifier">.progress</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">72</td>
                    <td class="coverage">25<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># if .y is not a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">75</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="string">"in map2(.x,.y,...) the .y is not a disk.frame, so returning a list instead of a disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">f_for_passing</span> <span class="operator">=</span> <span class="identifier">force</span><span class="paren">(</span><span class="identifier">.f</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ddd</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmp_disk.frame</span> <span class="operator">=</span> <span class="identifier">force</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">furrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_map2</span><span class="paren">(</span><span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">tmp_disk.frame</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">.y</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">xs</span>, <span class="identifier">ys</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">81</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">ddd</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">tmp_disk.frame</span>, <span class="identifier">xs</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span>, <span class="identifier">ys</span><span class="paren">)</span>, <span class="identifier">ddd</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">pryr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">do_call</span><span class="paren">(</span><span class="identifier">f_for_passing</span>, <span class="identifier">ddd</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">89</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname map2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">map_by_chunk_id</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">92</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">warning</span><span class="paren">(</span><span class="string">"map_by_chunk_id is deprecated. Use map2 instead"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">93</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">map2.disk.frame</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">.f</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/left_join.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Performs join/merge for disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' join.df = left_join(cars.df, cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(join.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">left_join.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_left_join"</span><span class="paren">)</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">13</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># note that x is named .data in the lazy evaluation</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">quo</span><span class="paren">(</span><span class="identifier">left_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">eval_tidy</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">26</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"both x and y are disk.frames. You need to specify merge_by_chunk_id = TRUE or FALSE explicitly"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">29</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncy</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"merge_by_chunk_id = FALSE. This will take significantly longer and the preparations needed are performed eagerly which may lead to poor performance. Consider making y a data.frame or set merge_by_chunk_id = TRUE for better performance."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">left_join.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#} else if ((identical(shardkey(x)$shardkey, "") &amp; identical(shardkey(y)$shardkey, "")) | identical(shardkey(x), shardkey(y))) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdot</span> <span class="operator">=</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map2.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">llj</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">lift</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">left_join</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#left_join(.x, .y, by = by, copy = copy, ...)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">llj</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">x</span><span class="operator">=</span><span class="identifier">.x</span>, <span class="identifier">y</span> <span class="operator">=</span><span class="identifier">.y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span><span class="paren">)</span>, <span class="identifier">dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># TODO if the shardkey are the same and only the shardchunks are different then just shard again on one of them is fine</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"merge_by_chunk_id is TRUE but shardkey(x) does NOT equal to shardkey(y). You may want to perform a hard_group_by() on both x and/or y or set merge_by_chunk_id = FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/is_disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Checks if a folder is a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame or directory to check </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' is_disk.frame(cars) # FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' is_disk.frame(cars.df) # TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">is_disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">##browser</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">684<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">29<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">655<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="string">"character"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># character then check the path</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">280<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">404<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">&lt;-</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">type</span><span class="operator">=</span><span class="string">"file"</span>, <span class="identifier">all</span>  <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if all files are fst</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">404<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">files</span><span class="paren">)</span><span class="operator">&gt;</span><span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">32<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">any</span><span class="paren">(</span><span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_lgl</span><span class="paren">(</span><span class="identifier">files</span>, <span class="operator">~</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">grep</span><span class="paren">(</span><span class="identifier">glob2rx</span><span class="paren">(</span><span class="string">"*.fst"</span><span class="paren">)</span>, <span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># some of the fiels do not have a .fst extension</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">403<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dirs</span> <span class="operator">=</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">type</span><span class="operator">=</span><span class="string">"directory"</span>, <span class="identifier">all</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">403<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">dirs</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">403<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">dirs</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">10<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">substr</span><span class="paren">(</span><span class="identifier">dirs</span>, <span class="identifier">nchar</span><span class="paren">(</span><span class="identifier">dirs</span><span class="paren">)</span><span class="operator">-</span><span class="number">8</span>,<span class="identifier">nchar</span><span class="paren">(</span><span class="identifier">dirs</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">!=</span> <span class="string">".metadata"</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">403<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">return</span><span class="paren">(</span><span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/nchunks.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns the number of chunks in a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param skip.ready.check NOT implemented</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunk(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nchunks</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">235<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"nchunks"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname nchunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nchunk</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"nchunk"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname nchunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nchunk.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">nchunks.disk.frame</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_ls</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname nchunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">nchunks.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">skip.ready.check</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#if(!skip.ready.check) stopifnot(is_ready(df))</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fpath</span> <span class="operator">&lt;-</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.dir.disk.frame</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">568<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">fpath</span>, <span class="identifier">type</span><span class="operator">=</span><span class="string">"file"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="number">1</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/setup.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Set up disk.frame environment</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param workers the number of workers (background R processes in the</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param future_backend which future backend to use for parallelization</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param gui Whether to use a Graphical User Interface (GUI) for selecting the options. Defaults to FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to `future::plan`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future plan multiprocess nbrOfWorkers sequential</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' if (interactive()) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   # setup disk.frame to use multiple workers these may use more than two</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   # cores, and is therefore not allowed on CRAN. Hence it's set to run only in</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   # interactive session</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   setup_disk.frame()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   # use a Shiny GUI to adjust settings</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   # only run in interactive()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'   setup_disk.frame(gui = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # set the number workers to 2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' setup_disk.frame(2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # if you do not wish to use multiple workers you can set it to sequential</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' setup_disk.frame(future_backend=future::sequential)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">setup_disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">workers</span> <span class="operator">=</span> <span class="identifier">parallel</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">detectCores</span><span class="paren">(</span><span class="identifier">logical</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>, <span class="identifier">future_backend</span> <span class="operator">=</span> <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">multiprocess</span>, <span class="keyword">...</span>, <span class="identifier">gui</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">gui</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">plan</span><span class="paren">(</span><span class="identifier">future_backend</span>, <span class="identifier">workers</span> <span class="operator">=</span> <span class="identifier">workers</span>, <span class="identifier">gc</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">message</span><span class="paren">(</span><span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"The number of workers available for disk.frame is %d"</span>, <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nbrOfWorkers</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># do not limit the amount of transfers to other workers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># this is not allowed by CRAN policy</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#options(future.globals.maxSize = future.globals.maxSize)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#options(disk.frame.nworkers = workers)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">gui</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="operator">!</span><span class="identifier">requireNamespace</span><span class="paren">(</span><span class="string">"shiny"</span>, <span class="identifier">quietly</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">36</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Package \"shiny\" must be installed to use GUI. You can install shiny using install.packages('shiny')"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">           <span class="identifier">call</span>. <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">40</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ui</span> <span class="operator">&lt;-</span> <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fluidPage</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">h1</span><span class="paren">(</span><span class="string">"disk.frame settings"</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">42</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">sliderInput</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="string">"nbrOfWorkers"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"Number of workers (recommendation = %d)"</span>, <span class="identifier">parallel</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">detectCores</span><span class="paren">(</span><span class="identifier">logical</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="number">1</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">46</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">parallel</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">detectCores</span><span class="paren">(</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">47</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">value</span> <span class="operator">=</span> <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nbrOfWorkers</span><span class="paren">(</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">step</span> <span class="operator">=</span> <span class="number">1</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">49</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">includeMarkdown</span><span class="paren">(</span><span class="identifier">system.file</span><span class="paren">(</span><span class="string">"options.rmd"</span>, <span class="identifier">package</span><span class="operator">=</span><span class="string">"disk.frame"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># , shiny::checkboxInput(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   "inf_fgm", </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   "Recommended: Set Maximum transfer size between workers to Inf (so ignore slider below)", </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   value = ifelse(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#     is.null(getOption("future.globals.maxSize")), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#     TRUE, </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#     is.infinite(getOption("future.globals.maxSize")))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># )</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># ,shiny::sliderInput(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   "future.globals.maxSize",</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   "Maximum transfer size between workers (gb)",</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   0,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   ifelse(is.infinite(memory.limit()), 3904, memory.limit()/1024/1024/1024),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   value = ifelse(is.infinite(getOption("future.globals.maxSize")), 3904, memory.limit()/1024/1024/1024),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#   step = 0.5</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># )</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">68</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">server</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">input</span>, <span class="identifier">output</span>, <span class="identifier">session</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">69</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">observe</span><span class="paren">(</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">70</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">plan</span><span class="paren">(</span><span class="identifier">future_backend</span>, <span class="identifier">workers</span> <span class="operator">=</span> <span class="identifier">input</span><span class="operator">$</span><span class="identifier">nbrOfWorkers</span>, <span class="identifier">gc</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#shiny::observe({</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#if(input$inf_fgm) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="comment">#options(future.globals.maxSize = Inf)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#} else {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="comment">#options(future.globals.maxSize = input$future.globals.maxSize*1024*1024*1024)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#})</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">82</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shiny</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">shinyApp</span><span class="paren">(</span><span class="identifier">ui</span>, <span class="identifier">server</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">84</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"setup_disk.frame: gui must be set to either TRUE or FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/semi_join.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param y a data.frame or disk.frame. If data.frame then returns lazily; if disk.frame it performs the join eagerly and return a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir output directory for disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname join </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' join.df = semi_join(cars.df, cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(join.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">semi_join.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_semi_join"</span><span class="paren">)</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">quo</span><span class="paren">(</span><span class="identifier">semi_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">eval_tidy</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">27</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"both x and y are disk.frames. You need to specify merge_by_chunk_id = TRUE or FALSE explicitly"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncy</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"merge_by_chunk_id = FALSE. This will take significantly longer and the preparations needed are performed eagerly which may lead to poor performance. Consider making y a data.frame or set merge_by_chunk_id = TRUE for better performance."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">semi_join.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map2.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">43</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">45</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">semi_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="keyword">...</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># TODO if the shardkey are the same and only the shardchunks are different then just shard again on one of them is fine</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">52</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"merge_by_chunk_id is TRUE but shardkey(x) does NOT equal to shardkey(y). You may want to perform a hard_group_by() on both x and/or y or set merge_by_chunk_id = FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/add_chunk.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Add a chunk to the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df the disk.frame to add a chunk to</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param chunk a data.frame to be added as a chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param chunk_id a numeric number indicating the id of the chunk. If NULL it will be set to the largest chunk_id + 1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param full.names whether the chunk_id name match should be to the full file path not just the file name</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # create a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df_path = file.path(tempdir(), "tmp_add_chunk")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' diskf = disk.frame(df_path)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # add a chunk to diskf</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' add_chunk(diskf, cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' add_chunk(diskf, cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(diskf) # 2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df2 = disk.frame(file.path(tempdir(), "tmp_add_chunk2"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # add chunks by specifying the chunk_id number; this is especially useful if</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # you wish to add multiple chunk in parralel</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' add_chunk(df2, data.frame(chunk=1), 1)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' add_chunk(df2, data.frame(chunk=2), 3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(df2) # 2</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' dir(attr(df2, "path"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # [1] "1.fst" "3.fst"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(diskf)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">add_chunk</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunk</span>, <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># sometimes chunk_id is defined in terms of itself</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">force</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is_disk.frame</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">42</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"can not add_chunk as this is not a disk.frame"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># get the metadata for all chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">files</span> <span class="operator">&lt;-</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">type</span><span class="operator">=</span><span class="string">"file"</span>, <span class="identifier">glob</span> <span class="operator">=</span> <span class="string">"*.fst"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment"># if a chunk_id is not specified</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">22<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="number">1</span> <span class="operator">+</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_int</span><span class="paren">(</span><span class="identifier">files</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">53</td>
                    <td class="coverage">58<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">s</span> <span class="operator">=</span> <span class="identifier">stringr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">str_extract</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="string">"[:digit:]+\\.fst"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">58<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">as.integer</span><span class="paren">(</span><span class="identifier">substr</span><span class="paren">(</span><span class="identifier">s</span>, <span class="number">1</span>, <span class="identifier">nchar</span><span class="paren">(</span><span class="identifier">s</span><span class="paren">)</span> <span class="operator">-</span> <span class="number">4</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">22<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span>, <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">files</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">filename</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>,<span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"{as.integer(chunk_id)}.fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span> <span class="comment"># if the chunk_id is not numeric</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">full.names</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">65</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">67</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">chunk_id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">71</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_exists</span><span class="paren">(</span><span class="identifier">filename</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">72</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"failed to add_chunk as chunk_id = {chunk_id} already exist"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">75</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">files</span>, <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">metadata_fst</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">77</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">types</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"unknown"</span>, <span class="string">"character"</span>, <span class="string">"factor"</span>, <span class="string">"ordered factor"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">78</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="string">"integer"</span>, <span class="string">"POSIXct"</span>, <span class="string">"difftime"</span>, <span class="string">"IDate"</span>, <span class="string">"ITime"</span>, <span class="string">"double"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">79</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="string">"Date"</span>, <span class="string">"POSIXct"</span>, <span class="string">"difftime"</span>, <span class="string">"ITime"</span>, <span class="string">"logical"</span>, <span class="string">"integer64"</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">80</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">               <span class="string">"nanotime"</span>, <span class="string">"raw"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># need to ensure that all column names and types match</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">83</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">imap_dfr</span><span class="paren">(</span><span class="identifier">metas</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">84</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="operator">~</span><span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">85</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="identifier">colnames</span> <span class="operator">=</span> <span class="identifier">.x</span><span class="operator">$</span><span class="identifier">columnNames</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">86</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="identifier">coltypes</span> <span class="operator">=</span> <span class="identifier">types</span><span class="paren">[</span><span class="identifier">.x</span><span class="operator">$</span><span class="identifier">columnTypes</span><span class="paren">]</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">87</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                                <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">89</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df_summ</span> <span class="operator">=</span> <span class="identifier">metas_df</span><span class="paren">[</span>,<span class="identifier">.N</span>,.<span class="paren">(</span><span class="identifier">colnames</span>, <span class="identifier">coltypes</span><span class="paren">)</span><span class="paren">]</span><span class="paren">[</span><span class="identifier">order</span><span class="paren">(</span><span class="identifier">N</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">90</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df_summ</span><span class="paren">[</span>,<span class="identifier">existing_df</span> <span class="operator">:</span><span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">92</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">new_chunk_meta</span> <span class="operator">=</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">93</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data.table</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">94</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">colnames</span> <span class="operator">=</span> <span class="identifier">names</span><span class="paren">(</span><span class="identifier">chunk</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">95</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">coltypes</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map</span><span class="paren">(</span><span class="identifier">chunk</span>, <span class="identifier">typeof</span><span class="paren">)</span> <span class="operator">%&gt;%</span> <span class="identifier">unlist</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">96</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">new_chunk</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">98</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">merged_meta</span> <span class="operator">=</span> <span class="identifier">full_join</span><span class="paren">(</span><span class="identifier">new_chunk_meta</span>, <span class="identifier">metas_df_summ</span>, <span class="identifier">by</span><span class="operator">=</span><span class="identifier">c</span><span class="paren">(</span><span class="string">"colnames"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">99</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">merged_meta</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">100</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">101</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># find out which vars are matched</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">102</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">check_vars</span> <span class="operator">=</span> <span class="identifier">full_join</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">103</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">new_chunk_meta</span><span class="paren">[</span>,.<span class="paren">(</span><span class="identifier">colnames</span>, <span class="identifier">new_chunk</span><span class="paren">)</span><span class="paren">]</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">104</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">metas_df</span><span class="paren">[</span>,.<span class="paren">(</span><span class="identifier">colnames</span><span class="operator">=</span><span class="identifier">unique</span><span class="paren">(</span><span class="identifier">colnames</span><span class="paren">)</span>, <span class="identifier">existing_df</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">]</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="string">"colnames"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">105</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">106</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">check_vars</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">107</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">check_vars</span><span class="paren">[</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">new_chunk</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">108</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">109</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">110</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="string">"these variables are in the disk.frame but not in the new chunk:  \n {paste0(check_vars[is.na(new_chunk), colnames], collapse=',\n  ')}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">111</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">112</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">check_vars</span><span class="paren">[</span><span class="identifier">is.na</span><span class="paren">(</span><span class="identifier">existing_df</span><span class="paren">)</span><span class="paren">]</span><span class="paren">)</span> <span class="operator">&gt;</span> <span class="number">0</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">113</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"these variables are in the new chunk but not in the existing disk.frame: {paste0(check_vars[is.na(existing_df), colnames], collapse=', ')}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">114</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">115</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">116</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># find out which vars are matched but the types don't match</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">117</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df_summ1</span> <span class="operator">=</span> <span class="identifier">merged_meta</span><span class="paren">[</span><span class="identifier">existing_df</span> <span class="operator">==</span> <span class="literal">TRUE</span> <span class="operator">&amp;</span> <span class="identifier">new_chunk</span> <span class="operator">==</span> <span class="literal">TRUE</span> <span class="operator">&amp;</span> <span class="identifier">coltypes.x</span> <span class="operator">!=</span> <span class="identifier">coltypes.y</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">118</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># find incompatible types</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">119</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df_summ1</span><span class="paren">[</span>, <span class="identifier">incompatible_types</span> <span class="operator">:</span><span class="operator">=</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">120</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">coltypes.x</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"integer"</span>, <span class="string">"double"</span>, <span class="string">"Date"</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">coltypes.y</span> <span class="operator">==</span> <span class="string">"character"</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">121</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">coltypes.x</span> <span class="operator">==</span> <span class="string">"character"</span> <span class="operator">&amp;</span> <span class="identifier">coltypes.y</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"integer"</span>, <span class="string">"double"</span>, <span class="string">"Date"</span><span class="paren">)</span> <span class="operator">|</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">122</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">coltypes.x</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"integer"</span>, <span class="string">"double"</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">coltypes.y</span> <span class="operator">==</span> <span class="string">"Date"</span> <span class="operator">|</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">123</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">coltypes.x</span> <span class="operator">==</span> <span class="string">"Date"</span> <span class="operator">&amp;</span> <span class="identifier">coltypes.y</span> <span class="operator">%in%</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"integer"</span>, <span class="string">"double"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">124</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">125</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">126</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">metas_df_summ2</span> <span class="operator">=</span> <span class="identifier">metas_df_summ1</span><span class="paren">[</span><span class="identifier">incompatible_types</span> <span class="operator">==</span> <span class="literal">TRUE</span>,<span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">127</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">128</td>
                    <td class="coverage">20<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">metas_df_summ2</span><span class="paren">)</span><span class="operator">&gt;</span><span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">129</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="string">"the belows types are incompatible between the new chunk and the disk.frame; this chunk can not be added"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">130</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">message</span><span class="paren">(</span><span class="identifier">metas_df_summ2</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">131</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">""</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">132</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">133</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">134</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">135</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">chunk</span>, <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">chunk_id</span>,<span class="string">".fst"</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">136</td>
                    <td class="coverage">24<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">137</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/inner_join.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' join.df = inner_join(cars.df, cars.df, merge_by_chunk_id = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(join.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">inner_join.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_inner_join"</span><span class="paren">)</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">12</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">overwrite</span> <span class="operator">&amp;</span> <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_exists</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">22</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_create</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">quo</span><span class="paren">(</span><span class="identifier">inner_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">eval_tidy</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"both x and y are disk.frames. You need to specify merge_by_chunk_id = TRUE or FALSE explicitly"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">38</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncy</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">inner_join.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">dotdotdot</span> <span class="operator">&lt;-</span> <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map2.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">53</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">55</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="comment">#inner_join(.x, .y, by = by, copy = copy, ..., overwrite = overwrite)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">lij</span> <span class="operator">=</span> <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">lift</span><span class="paren">(</span><span class="identifier">dplyr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">inner_join</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">59</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">lij</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.x</span>, <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">.y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span><span class="paren">)</span>, <span class="identifier">dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">60</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># TODO if the shardkey are the same and only the shardchunks are different then just shard again on one of them is fine</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">64</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"merge_by_chunk_id is TRUE but shardkey(x) does NOT equal to shardkey(y). You may want to perform a hard_group_by() on both x and/or y or set merge_by_chunk_id = FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/data.table.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' [ interface for disk.frame using fst backend</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... same as data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param keep the columns to srckeep</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param rbind Whether to rbind the chunks. Defaults to TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param use.names Same as in data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param fill Same as in data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param idcol Same as in data.table::rbindlist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future.apply future_lapply</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table rbindlist </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom globals findGlobals</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' speed_limit = 50</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df[speed &lt; speed_limit ,.N, cut(dist, pretty(dist))]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">`[.disk.frame`</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">keep</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">rbind</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">keep_for_future</span> <span class="operator">=</span> <span class="identifier">keep</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">dotdotdot</span> <span class="operator">=</span> <span class="identifier">substitute</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span> <span class="comment">#this is an alist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ag</span> <span class="operator">=</span> <span class="identifier">globals</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">findGlobals</span><span class="paren">(</span><span class="identifier">dotdotdot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">ag</span> <span class="operator">=</span> <span class="identifier">setdiff</span><span class="paren">(</span><span class="identifier">ag</span>, <span class="string">""</span><span class="paren">)</span> <span class="comment"># "" can cause issues with future</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">future.apply</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">future_lapply</span><span class="paren">(</span><span class="identifier">get_chunk_ids</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">strip_extension</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#lapply(get_chunk_ids(df, strip_extension = FALSE), function(chunk_id) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">chunk</span> <span class="operator">=</span> <span class="identifier">get_chunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunk_id</span>, <span class="identifier">keep</span> <span class="operator">=</span> <span class="identifier">keep_for_future</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">chunk</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">expr</span> <span class="operator">&lt;-</span> <span class="identifier">quote</span><span class="paren">(</span><span class="identifier">chunk</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">expr</span> <span class="operator">&lt;-</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">expr</span>, <span class="identifier">dotdotdot</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">&lt;-</span> <span class="identifier">do.call</span><span class="paren">(</span><span class="identifier">`[`</span>, <span class="identifier">expr</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">26<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span>, <span class="identifier">future.globals</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"df"</span>, <span class="string">"keep_for_future"</span>, <span class="string">"dotdotdot"</span>, <span class="identifier">ag</span><span class="paren">)</span>, <span class="identifier">future.packages</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="string">"data.table"</span>,<span class="string">"disk.frame"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">rbind</span> <span class="operator">&amp;</span> <span class="identifier">all</span><span class="paren">(</span><span class="identifier">sapply</span><span class="paren">(</span><span class="identifier">res</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">rbindlist</span><span class="paren">(</span><span class="identifier">res</span>, <span class="identifier">use.names</span> <span class="operator">=</span> <span class="identifier">use.names</span>, <span class="identifier">fill</span> <span class="operator">=</span> <span class="identifier">fill</span>, <span class="identifier">idcol</span> <span class="operator">=</span> <span class="identifier">idcol</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">rbind</span><span class="paren">)</span>  <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">42</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">unlist</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">44</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># Solutions from https://stackoverflow.com/questions/57122960/how-to-use-non-standard-evaluation-nse-to-evaluate-arguments-on-data-table?answertab=active#tab-top</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># `[.dd` &lt;- function(x, ...) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   code &lt;- rlang::enexprs(...)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   lapply(x, function(dt) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#     ex &lt;- rlang::expr(dt[!!!code])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#     rlang::eval_tidy(ex)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   })</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># `[.dd` &lt;- function(x,...) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   a &lt;- substitute(...()) #this is an alist</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   expr &lt;- quote(x[[i]])</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   expr &lt;- c(expr, a)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   res &lt;- list()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   for (i in seq_along(x)) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#     res[[i]] &lt;- do.call(`[`, expr)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#   res</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># }</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/anti_join.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param by join by</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param copy same as dplyr::anti_join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param merge_by_chunk_id the merge is performed by chunk id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... same as dplyr's joins</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom rlang quo enquos</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr anti_join left_join full_join semi_join inner_join</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @return disk.frame or data.frame/data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df.df = as.disk.frame(data.frame(x = 1:3, y = 4:6), overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df2.df = as.disk.frame(data.frame(x = 1:2, z = 10:11), overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' anti_joined.df = anti_join(df.df, df2.df) </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' anti_joined.df %&gt;% collect</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' anti_joined.data.frame = anti_join(df.df, data.frame(x = 1:2, z = 10:11))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df2.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(anti_joined.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">anti_join.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="literal">NULL</span>, <span class="identifier">copy</span><span class="operator">=</span><span class="literal">FALSE</span>, <span class="keyword">...</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_disk_frame_anti_join"</span><span class="paren">)</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#browser()</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">12<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">quo_dotdotdot</span> <span class="operator">=</span> <span class="identifier">enquos</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">map_dfr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">quo</span><span class="paren">(</span><span class="identifier">anti_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="operator">!</span><span class="operator">!</span><span class="operator">!</span><span class="identifier">quo_dotdotdot</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rlang</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">eval_tidy</span><span class="paren">(</span><span class="identifier">code</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">merge_by_chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"both x and y are disk.frames. You need to specify merge_by_chunk_id = TRUE or FALSE explicitly"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">42</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">by</span> <span class="operator">&lt;-</span> <span class="identifier">intersect</span><span class="paren">(</span><span class="identifier">names</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">names</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncx</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">46</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">ncy</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">47</td>
                    <td class="coverage">8<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">==</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">warning</span><span class="paren">(</span><span class="string">"merge_by_chunk_id = FALSE. This will take significantly longer and the preparations needed are performed eagerly which may lead to poor performance. Consider making y a data.frame or set merge_by_chunk_id = TRUE for better performance."</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">y</span> <span class="operator">=</span> <span class="identifier">hard_group_by</span><span class="paren">(</span><span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">max</span><span class="paren">(</span><span class="identifier">ncy</span>,<span class="identifier">ncx</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">anti_join.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">53</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span> <span class="operator">&amp;</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="string">""</span><span class="paren">)</span><span class="paren">)</span> <span class="operator">|</span> <span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment">#res = map2.disk.frame(x, y, ~{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map2</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">56</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">57</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">58</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">.x</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">          <span class="keyword">return</span><span class="paren">(</span><span class="identifier">data.table</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">61</td>
                    <td class="coverage">21<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">anti_join</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">.y</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span>, <span class="identifier">copy</span> <span class="operator">=</span> <span class="identifier">copy</span>, <span class="keyword">...</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">62</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">63</td>
                    <td class="coverage">4<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="comment"># TODO if the shardkey are the same and only the shardchunks are different then just shard again on one of them is fine</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">66</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">stop</span><span class="paren">(</span><span class="string">"merge_by_chunk_id is TRUE but shardkey(x) does NOT equal to shardkey(y). You may want to perform a hard_group_by() on both x and/or y or set merge_by_chunk_id = FALSE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/merge.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Merge function for disk.frames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param y a disk.frame or data.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param by the merge by keys</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The output directory for the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param merge_by_chunk_id if TRUE then only chunks in df1 and df2 with the same chunk id will get merged</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite overwrite the outdir or not</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to merge and map.disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table data.table setDT</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' b = as.disk.frame(data.frame(a = 51:150, b = 1:100))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' d = as.disk.frame(data.frame(a = 151:250, b = 1:100))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' bd.df = merge(b, d, by = "b")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(b)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(d)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(bd.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">merge.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">y</span>, <span class="identifier">by</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="keyword">...</span>, <span class="identifier">merge_by_chunk_id</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span>  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#fs::dir_create(outdir)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">yby</span> <span class="operator">=</span> <span class="identifier">c</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">y</span><span class="operator">=</span><span class="identifier">y</span>, <span class="identifier">by</span><span class="operator">=</span><span class="identifier">by</span><span class="paren">)</span>, <span class="identifier">list</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">map</span><span class="paren">(</span><span class="identifier">x</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">do.call</span><span class="paren">(</span><span class="identifier">merge</span>, <span class="identifier">c</span><span class="paren">(</span><span class="identifier">list</span><span class="paren">(</span><span class="identifier">x</span> <span class="operator">=</span> <span class="identifier">.x</span><span class="paren">)</span>, <span class="identifier">yby</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">res</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span>, <span class="identifier">outdir</span><span class="operator">=</span><span class="identifier">outdir</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span>  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">merge_by_chunk_id</span> <span class="operator">|</span> <span class="paren">(</span><span class="identifier">identical</span><span class="paren">(</span><span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">shardkey</span><span class="paren">(</span><span class="identifier">y</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># ifthe shardkeys are the same then only need to match by segment id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># as account with the same shardkey must end up in the same segment</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path1</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">36</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">path2</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">y</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df3</span> <span class="operator">=</span> <span class="identifier">merge</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">41</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pathA</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path1</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">44</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">chunk_id</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path2</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">45</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">pathB</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">path2</span>,<span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">48</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">df3</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">49</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df3</span><span class="paren">[</span>,<span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">50</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data1</span> <span class="operator">=</span> <span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">pathA</span>,<span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">51</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data2</span> <span class="operator">=</span> <span class="identifier">read_fst</span><span class="paren">(</span><span class="identifier">pathB</span>,<span class="identifier">as.data.table</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">52</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">data3</span> <span class="operator">=</span> <span class="identifier">force</span><span class="paren">(</span><span class="identifier">merge</span><span class="paren">(</span><span class="identifier">data1</span>, <span class="identifier">data2</span>, <span class="identifier">by</span> <span class="operator">=</span> <span class="identifier">by</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">53</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">data1</span><span class="paren">)</span>; <span class="identifier">rm</span><span class="paren">(</span><span class="identifier">data2</span><span class="paren">)</span>; <span class="identifier">gc</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">54</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">write_fst</span><span class="paren">(</span><span class="identifier">data3</span>, <span class="identifier">glue</span><span class="paren">(</span><span class="string">"{outdir}/{.BY}"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">55</td>
                    <td class="coverage">5<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">56</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span>, <span class="identifier">chunk_id</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">57</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">59</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"Cartesian joins are currently not implemented. Either make y a data.frame or set merge_by_chunk_id to TRUE"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">61</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># have to make every possible combination</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">62</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># path1 = attr(df1,"path")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">63</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># path2 = attr(df2,"path")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">64</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">65</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># df3 = merge(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">66</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   data.table(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">67</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     justmerge = TRUE,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">68</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     chunk_id1 = list.files(path1), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">69</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     pathA = list.files(path1,full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">70</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   ),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">71</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   data.table(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">72</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     justmerge = TRUE,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">73</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     chunk_id2 = list.files(path2), </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">74</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     pathB = list.files(path2,full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">75</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   ),</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">76</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   by = "justmerge",</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">77</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   all=TRUE,</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">78</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   allow.cartesian = TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">79</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># )</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">80</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">81</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">82</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># setDT(df3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">83</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># i &lt;- 0</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">84</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># mapply(function(pathA, pathB) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">85</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   stop("error")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">86</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   data1 = read_fst(pathA,as.data.table = TRUE, columns = c("ACCOUNT_ID","MONTH_KEY"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">87</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   data2 = read_fst(pathB,as.data.table = TRUE, columns = c("ACCOUNT_ID","MONTH_KEY"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">88</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   data3 = merge(data1, data2, ...)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">89</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   rm(data1); rm(data2); gc()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">90</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   if(nrow(data3) &gt; 0) {</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">91</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     i &lt;&lt;- i + 1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">92</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#     write_fst(data3, glue("{outdir}/{i}.fst"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">93</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   }</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">94</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment">#   NULL</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">95</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># },df3$pathA, df3$pathB)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">96</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="comment"># return(disk.frame(outdir))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">97</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">98</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/shard.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Shard a data.frame/data.table or disk.frame into chunk and saves it into a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df A data.frame/data.table or disk.frame. If disk.frame, then rechunk(df, ...) is run</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby The column(s) to shard the data by.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks The number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The output directory of the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite If TRUE then the chunks are overwritten</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table setDT</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # shard the cars data.frame by speed so that rows with the same speed are in the same chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' iris.df = shard(iris, "Species")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(iris.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">shard</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">shardby</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="keyword">...</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">219<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">219<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">161<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"df[,.out.disk.frame.id := hashstr2i(as.character({shardby}), nchunks)]"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">57<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">shardby_list</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"paste0({paste0(sort(shardby),collapse=',')})"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">57<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">code</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"df[,.out.disk.frame.id := hashstr2i({shardby_list}, nchunks)]"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">tryCatch</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">31</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span><span class="operator">=</span><span class="identifier">code</span><span class="paren">)</span><span class="paren">)</span>,</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">error</span> <span class="operator">=</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">e</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">        <span class="identifier">message</span><span class="paren">(</span><span class="string">"error occurred in shard"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">write_disk.frame</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span><span class="paren">)</span>  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">218<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">40</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">rechunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' `distribute` is an alias for `shard`</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname shard</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">distribute</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">48</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"shard"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/names.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Return the column names of the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_ls</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fst metadata_fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">colnames</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">9</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">UseMethod</span><span class="paren">(</span><span class="string">"colnames"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname colnames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">names.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">colnames.disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname colnames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">colnames.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">res</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">x</span>, <span class="string">"path"</span><span class="paren">)</span> <span class="operator">%&gt;%</span> </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_ls</span><span class="paren">(</span><span class="identifier">type</span><span class="operator">=</span><span class="string">"file"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">length</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">)</span> <span class="operator">==</span> <span class="number">0</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">24</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">vector</span><span class="paren">(</span><span class="string">"character"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">14<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fst</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">metadata_fst</span><span class="paren">(</span><span class="identifier">res</span><span class="paren">[</span><span class="number">1</span><span class="paren">]</span><span class="paren">)</span><span class="operator">$</span><span class="identifier">columnNames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname colnames</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">colnames.default</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">2<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">colnames</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/as.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Make a data.frame into a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite if TRUE the outdir will be overwritten, if FALSE it will throw an error if the directory is not empty</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress the compression level 0-100; 100 is highest</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby The shardkey</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to output_disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @import fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom data.table setDT</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # write to temporary location</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars) </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # specify a different path in the temporary folder, you are free to choose a different folder</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars_new_location.df = as.disk.frame(cars, outdir = file.path(tempdir(), "some_path.df"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # specify a different number of chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # this writes to tempdir() by default</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars_chunks.df = as.disk.frame(cars, nchunks = 4, overwrite = TRUE) </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars_new_location.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars_chunks.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">as.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="number">50</span>,<span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">63<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"data.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">63<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">setDT</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">shardby</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">odfi</span> <span class="operator">=</span> <span class="identifier">rep</span><span class="paren">(</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nchunks</span>, <span class="identifier">each</span> <span class="operator">=</span> <span class="identifier">ceiling</span><span class="paren">(</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="operator">/</span><span class="identifier">nchunks</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">34</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">odfi</span> <span class="operator">=</span> <span class="identifier">odfi</span><span class="paren">[</span><span class="number">1</span><span class="operator">:</span><span class="identifier">nrow</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">df</span><span class="paren">[</span>, <span class="identifier">.out.disk.frame.id</span> <span class="operator">:</span><span class="operator">=</span> <span class="identifier">odfi</span><span class="paren">]</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">37</td>
                    <td class="coverage">62<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">write_disk.frame</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">outdir</span>, <span class="identifier">nchunks</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">shardby</span><span class="operator">=</span><span class="string">""</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">39</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">shard</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/compute.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Compute without writing</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Perform the computation; same as calling map without .f and lazy = FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir the output directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite whether to overwrite or note</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param name not used kept for compatibility with dplyr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... NOT used. Kept for dplyr compatibility</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr compute</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df2 = cars.df %&gt;% map(~.x)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # the computation is performed and the data is now stored elsewhere</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df3 = compute(cars.df2)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">compute.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">name</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="string">"tmp_df_"</span>, <span class="identifier">fileext</span><span class="operator">=</span><span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">write_disk.frame</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">outdir</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/get_chunk_ids.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Get the chunk IDs and files names</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param full.names If TRUE returns the full path to the file, Defaults to FALSE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param strip_extension If TRUE then the file extension in the chunk_id is removed. Defaults to TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to list.files</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom stringr fixed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the integer-string chunk IDs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk_ids(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the file name chunk IDs</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk_ids(cars.df, full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # return the file name chunk IDs with file extension</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' get_chunk_ids(cars.df, strip_extension = FALSE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">get_chunk_ids</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="keyword">...</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">strip_extension</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">lf</span> <span class="operator">=</span> <span class="identifier">list.files</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="identifier">full.names</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">242<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">full.names</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">119<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">return</span><span class="paren">(</span><span class="identifier">lf</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">123<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">purrr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">map_chr</span><span class="paren">(</span><span class="identifier">lf</span>, <span class="operator">~</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">627<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">tmp</span> <span class="operator">=</span> <span class="identifier">stringr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">str_split</span><span class="paren">(</span><span class="identifier">.x</span>,<span class="identifier">stringr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fixed</span><span class="paren">(</span><span class="string">"."</span><span class="paren">)</span>, <span class="identifier">simplify</span> <span class="operator">=</span> <span class="literal">TRUE</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">29</td>
                    <td class="coverage">627<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">l</span> <span class="operator">=</span> <span class="identifier">length</span><span class="paren">(</span><span class="identifier">tmp</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">627<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span><span class="paren">(</span><span class="identifier">l</span> <span class="operator">==</span> <span class="number">1</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="keyword">return</span><span class="paren">(</span><span class="identifier">tmp</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">32</td>
                    <td class="coverage">627<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="keyword">if</span><span class="paren">(</span><span class="identifier">strip_extension</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">33</td>
                    <td class="coverage">595<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">paste0</span><span class="paren">(</span><span class="identifier">tmp</span><span class="paren">[</span><span class="operator">-</span><span class="identifier">l</span><span class="paren">]</span>, <span class="identifier">collapse</span><span class="operator">=</span><span class="string">""</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">35</td>
                    <td class="coverage">32<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">.x</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/sample_frac.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Sample n rows from a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param tbl a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param size the proportion/fraction of rows to sample</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param replace TRUE to sample with replacement; FALSE to sample without replacement</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param weight weight of each row. NOT implemented</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .env for compatibility</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to dplyr</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr sample_frac</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @rdname sample</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(sample_frac(cars.df, 0.5))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">sample_frac.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">tbl</span>, <span class="identifier">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">.env</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">weight</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">20</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"sample_frac(..., weight =) is not implemented yet"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">delayed</span><span class="paren">(</span><span class="identifier">tbl</span>, <span class="operator">~</span><span class="identifier">sample_frac</span><span class="paren">(</span><span class="identifier">.x</span>, <span class="identifier">size</span>, <span class="identifier">replace</span>, <span class="identifier">weight</span>, <span class="identifier">.env</span>, <span class="keyword">...</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/remove_chunk.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Removes a chunk from the disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param chunk_id the chunk ID of the chunk to remove. If it's a number then return number.fst</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param full.names TRUE or FALSE. Defaults to FALSE. If true then chunk_id is the full path to the chunk otherwise it's the relative path</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # TODO add these to tests</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars, nchunks = 4)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # removes 3rd chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' remove_chunk(cars.df, 3)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(cars.df) # 3</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # removes 4th chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' remove_chunk(cars.df, "4.fst")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(cars.df) # 3</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#'</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # removes 2nd chunk</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' remove_chunk(cars.df, file.path(attr(cars.df, "path"), "2.fst"), full.names = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' nchunks(cars.df) # 1</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">remove_chunk</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunk_id</span>, <span class="identifier">full.names</span> <span class="operator">=</span> <span class="literal">FALSE</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">25</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">filename</span> <span class="operator">=</span> <span class="string">""</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">26</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">path</span> <span class="operator">=</span> <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">27</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">is.numeric</span><span class="paren">(</span><span class="identifier">chunk_id</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">28</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"{as.integer(chunk_id)}.fst"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">30</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">if</span> <span class="paren">(</span><span class="identifier">full.names</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">chunk_id</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">      <span class="identifier">filename</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">path</span>, <span class="identifier">chunk_id</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#if(filename %in% fs::dir_ls(path, glob="*.fst")) {</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">38</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_exists</span><span class="paren">(</span><span class="identifier">filename</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">39</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">file_delete</span><span class="paren">(</span><span class="identifier">filename</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span> <span class="keyword">else</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">41</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">warning</span><span class="paren">(</span><span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"the chunk {filename} does not exist and hence can't be removed; make sure you suffix the file with the .fst extension"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">43</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/csv2disk.frame_readr.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert CSV file(s) to disk.frame format</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_delete</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param infile The input CSV file or files</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param outdir The directory to output the disk.frame to</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param inmapfn A function to be applied to the chunk read in from CSV before the chunk is being written out. Commonly used to perform simple transformations. Defaults to the identity function (ie. no transformation)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param nchunks Number of chunks to output</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param in_chunk_size When reading in the file, how many lines to read in at once. This is different to nchunks which controls how many chunks are output</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param shardby The column(s) to shard the data by. For example suppose `shardby = c("col1","col2")`  then every row where the values `col1` and `col2` are the same will end up in the same chunk; this will allow merging by `col1` and `col2` to be more efficient</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param compress For fst backends it's a number between 0 and 100 where 100 is the highest compression ratio.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param overwrite Whether to overwrite the existing directory</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param header Whether the files have header. Defaults to TRUE</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param .progress A logical, for whether or not to print a progress bar for multiprocess, multisession, and multicore plans. From {furrr}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to data.table::fread, disk.frame::as.disk.frame, disk.frame::shard</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom pryr do_call</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tmpfile = tempfile()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' write.csv(cars, tmpfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' tmpdf = tempfile(fileext = ".df")</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' df = csv_to_disk.frame(tmpfile, outdir = tmpdf, overwrite = TRUE)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' fs::file_delete(tmpfile)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">csv_to_disk.frame_readr</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="identifier">outdir</span> <span class="operator">=</span> <span class="identifier">tempfile</span><span class="paren">(</span><span class="identifier">fileext</span> <span class="operator">=</span> <span class="string">".df"</span><span class="paren">)</span>, <span class="identifier">inmapfn</span> <span class="operator">=</span> <span class="identifier">base</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">I</span>, <span class="identifier">nchunks</span> <span class="operator">=</span> <span class="identifier">recommend_nchunks</span><span class="paren">(</span><span class="identifier">sum</span><span class="paren">(</span><span class="identifier">file.size</span><span class="paren">(</span><span class="identifier">infile</span><span class="paren">)</span><span class="paren">)</span><span class="paren">)</span>, </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                              <span class="identifier">in_chunk_size</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">shardby</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">compress</span><span class="operator">=</span><span class="number">50</span>, <span class="identifier">overwrite</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">header</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="identifier">.progress</span> <span class="operator">=</span> <span class="literal">TRUE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">29</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">overwrite_check</span><span class="paren">(</span><span class="identifier">outdir</span>, <span class="identifier">overwrite</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">31</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">disk.frame</span><span class="paren">(</span><span class="identifier">outdir</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">33</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">readr</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">read_delim_chunked</span><span class="paren">(</span><span class="identifier">infile</span>, <span class="keyword">function</span><span class="paren">(</span><span class="identifier">chunk</span>,<span class="identifier">i</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">34</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">add_chunk</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">chunk</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">35</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span>, <span class="identifier">chunk_size</span> <span class="operator">=</span> <span class="identifier">in_chunk_size</span>, <span class="keyword">...</span>, <span class="identifier">delim</span><span class="operator">=</span><span class="string">"|"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">37</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span> <span class="operator">=</span> <span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">nchunks</span><span class="operator">=</span><span class="identifier">disk.frame</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nchunks</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span>, <span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">shardby</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">nchunks</span>, <span class="identifier">compress</span> <span class="operator">=</span> <span class="identifier">compress</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">38</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/sample_n.R" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">sample_n.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">size</span> <span class="operator">=</span> <span class="number">1</span>, <span class="identifier">replace</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="identifier">weight</span> <span class="operator">=</span> <span class="literal">NULL</span>, <span class="identifier">.env</span> <span class="operator">=</span> <span class="literal">NULL</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">2</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">stop</span><span class="paren">(</span><span class="string">"not implemented yet"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">3</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">is.null</span><span class="paren">(</span><span class="identifier">weight</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">4</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="keyword">stop</span><span class="paren">(</span><span class="string">"sample_n(..., weight =) is not implemented yet"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#delayed(df, ~sample_frac(.x, size, replace, weight, .env))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/zzz.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">.onLoad</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">libname</span>, <span class="identifier">pkgname</span><span class="paren">)</span><span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom future nbrOfWorkers</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom crayon red blue green</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">.onAttach</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">libname</span>, <span class="identifier">pkgname</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="comment">#setup_disk.frame()</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">10</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">packageStartupMessage</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">11</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">crayon</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">red</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">12</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">13</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    "\n\n## Message from disk.frame:</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">We</span> <span class="identifier">have</span> <span class="paren">{</span><span class="identifier">future</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">nbrOfWorkers</span><span class="paren">(</span><span class="paren">)</span><span class="paren">}</span> <span class="identifier">workers</span> <span class="identifier">to</span> <span class="identifier">use</span> <span class="identifier">with</span> <span class="identifier">disk.frame</span>.</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">To change that use setup_disk.frame(workers = n) or just setup_disk.frame() to use the defaults.")),</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    crayon::green("\n\n</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">It</span> <span class="identifier">is</span> <span class="identifier">recommend</span> <span class="identifier">that</span> <span class="identifier">you</span> <span class="identifier">run</span> <span class="identifier">the</span> <span class="identifier">following</span> <span class="identifier">immediately</span> <span class="identifier">to</span> <span class="identifier">setup</span> <span class="identifier">disk.frame</span> <span class="identifier">with</span> <span class="identifier">multiple</span> <span class="identifier">workers</span> <span class="keyword">in</span> <span class="identifier">order</span> <span class="identifier">to</span> <span class="identifier">parallelize</span> <span class="identifier">your</span> <span class="identifier">operations</span><span class="operator">:</span>\<span class="identifier">n</span>\<span class="identifier">n</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">```r</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># this willl set disk.frame with multiple workers</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">setup_disk.frame</span><span class="paren">(</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># this will allow unlimited amount of data to be passed from worker to worker</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">options</span><span class="paren">(</span><span class="identifier">future.globals.maxSize</span> <span class="operator">=</span> <span class="literal">Inf</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">```</pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">6<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">\n\n"))</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">globalVariables</span><span class="paren">(</span><span class="identifier">c</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"syms"</span>, <span class="comment"># needed by dplyr to treat something as a symbol</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">30</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"."</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">".BY"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">32</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">".N"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">33</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">".SD"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">34</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">".out.disk.frame.id"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">35</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">":="</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">36</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"N"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">37</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"area"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">38</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"chunk_id"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">39</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"coltypes"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">40</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"coltypes.x"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">41</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"coltypes.y"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">42</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"ctot"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">43</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"existing_df"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">44</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"feature_s"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">45</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"h"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">46</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"height"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">47</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"incompatible_types"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">48</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"lag_height"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">49</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"new_chunk"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">50</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"ok"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">51</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"pathA"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">52</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"pathB"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">53</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"w"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">54</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"xid"</span>,</pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">55</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">                  <span class="string">"yid"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">56</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">57</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @useDynLib disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">58</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom Rcpp evalCpp</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">59</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#@exportPattern "^[[:alpha:]]+"</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">60</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="literal">NULL</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/delete.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Delete a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom fs dir_delete</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">delete</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">9</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  </pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">11</td>
                    <td class="coverage">3<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">fs</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">dir_delete</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>, <span class="string">"path"</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/print.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Print disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' a new print method for disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... not used</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom glue glue</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">print.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">9</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">a</span> <span class="operator">=</span> <span class="identifier">paste</span><span class="paren">(</span><span class="identifier">sep</span> <span class="operator">=</span> <span class="string">"\n"</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">10</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">             ,<span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"path: \"{attr(x,'path')}\""</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">11</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">             ,<span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"nchunks: {disk.frame::nchunks(x)}"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">12</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">             ,<span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"nrow: {disk.frame::nrow(x)}"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">13</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">             ,<span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="string">"ncol: {disk.frame::ncol(x)}\n"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">15</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">message</span><span class="paren">(</span><span class="identifier">a</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/as.data.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert disk.frame to data.frame by collecting all chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param row.names NULL or a character vector giving the row names for the data frame. Missing values are not allowed.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param optional logical. If TRUE, setting row names and converting column names (to syntactic names: see make.names) is optional. Note that all of R's base package as.data.frame() methods use optional only for column names treatment, basically with the meaning of data.frame(*, check.names = !optional). See also the make.names argument of the matrix method.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... additional arguments to be passed to or from methods.</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' as.data.frame(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">as.data.frame.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">row.names</span>, <span class="identifier">optional</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span> <span class="comment"># needs to retain x for consistency</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">as.data.frame</span><span class="paren">(</span><span class="identifier">collect</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">row.names</span>, <span class="identifier">optional</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">15</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">16</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Convert disk.frame to data.table by collecting all chunks</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">18</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">19</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param keep.rownames passed to as.data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">20</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param ... passed to as.data.table</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">21</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">22</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">23</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' library(data.table)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">24</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' as.data.table(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">27</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">28</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">29</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">as.data.table.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span>, <span class="identifier">keep.rownames</span> <span class="operator">=</span> <span class="literal">FALSE</span>, <span class="keyword">...</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">30</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">as.data.table</span><span class="paren">(</span><span class="identifier">collect</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span>, <span class="identifier">keep.rownames</span> <span class="operator">=</span> <span class="identifier">keep.rownames</span>, <span class="keyword">...</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">31</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/shardkey.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns the shardkey (not implemented yet)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom jsonlite fromJSON</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment"># TODO make this work</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">shardkey</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">7</td>
                    <td class="coverage">300<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">meta_file</span> <span class="operator">=</span> <span class="identifier">file.path</span><span class="paren">(</span><span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"path"</span><span class="paren">)</span>,<span class="string">".metadata"</span>, <span class="string">"meta.json"</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">8</td>
                    <td class="coverage">300<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="keyword">if</span><span class="paren">(</span><span class="operator">!</span><span class="identifier">file.exists</span><span class="paren">(</span><span class="identifier">meta_file</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">9</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">add_meta</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">11</td>
                    <td class="coverage">300<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">meta</span> <span class="operator">=</span> <span class="identifier">jsonlite</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">fromJSON</span><span class="paren">(</span><span class="identifier">meta_file</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">12</td>
                    <td class="coverage">300<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">list</span><span class="paren">(</span><span class="identifier">shardkey</span> <span class="operator">=</span> <span class="identifier">meta</span><span class="operator">$</span><span class="identifier">shardkey</span>, <span class="identifier">shardchunks</span> <span class="operator">=</span> <span class="identifier">meta</span><span class="operator">$</span><span class="identifier">shardchunks</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/srckeep.disk.frame.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Keep only the variables from the input listed in selections</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param df a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param selections The list of variables to keep from the input source</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @examples</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' cars.df = as.disk.frame(cars)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # when loading cars's chunks into RAM, load only the column speed</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' collect(srckeep(cars.df, "speed"))</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' # clean up cars.df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' delete(cars.df)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">srckeep</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">df</span>, <span class="identifier">selections</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">14</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">stopifnot</span><span class="paren">(</span><span class="string">"disk.frame"</span> <span class="operator">%in%</span> <span class="identifier">class</span><span class="paren">(</span><span class="identifier">df</span><span class="paren">)</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">attr</span><span class="paren">(</span><span class="identifier">df</span>,<span class="string">"keep"</span><span class="paren">)</span> <span class="operator">=</span> <span class="identifier">selections</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">df</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">17</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/tbl_vars.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Column names for RStudio auto-complete</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @description </span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Returns the names of the columns. Needed for RStudio to complete variable</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' names</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param x a disk.frame</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">6</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom dplyr tbl_vars</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">tbl_vars.disk.frame</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">9</td>
                    <td class="coverage">1<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">names.disk.frame</span><span class="paren">(</span><span class="identifier">x</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div id="R/util.r" class="hidden">
              <table class="table-condensed">
                <tbody>
                  <tr class="never">
                    <td class="num">1</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Helper function to evalparse some `glue::glue` string</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">2</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param code the code in character(string) format to evaluate</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">3</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param env the environment in which to evaluate the code</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">4</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">5</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">evalparseglue</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">code</span>, <span class="identifier">env</span> <span class="operator">=</span> <span class="identifier">parent.frame</span><span class="paren">(</span><span class="paren">)</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="missed">
                    <td class="num">6</td>
                    <td class="coverage">!</td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">eval</span><span class="paren">(</span><span class="identifier">parse</span><span class="paren">(</span><span class="identifier">text</span> <span class="operator">=</span> <span class="identifier">glue</span><span class="operator">:</span><span class="operator">:</span><span class="identifier">glue</span><span class="paren">(</span><span class="identifier">code</span>, <span class="identifier">.envir</span> <span class="operator">=</span> <span class="identifier">env</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">envir</span> <span class="operator">=</span> <span class="identifier">env</span><span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">7</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">8</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">9</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' Generate synthetic dataset for testing</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">10</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param N number of rows. Defaults to 200 million</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">11</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @param K controls the number of unique values for id. Some ids will have K distinct values while others have N/K distinct values</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">12</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @importFrom stats runif</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">13</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="comment">#' @export</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">14</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="identifier">gen_datatable_synthetic</span> <span class="operator">&lt;-</span> <span class="keyword">function</span><span class="paren">(</span><span class="identifier">N</span><span class="operator">=</span><span class="number">2e8</span>, <span class="identifier">K</span><span class="operator">=</span><span class="number">100</span><span class="paren">)</span> <span class="paren">{</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">15</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="identifier">data.table</span><span class="paren">(</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">16</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id1</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"id%03d"</span>,<span class="number">1</span><span class="operator">:</span><span class="identifier">K</span><span class="paren">)</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,      <span class="comment"># large groups (char)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">17</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id2</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"id%03d"</span>,<span class="number">1</span><span class="operator">:</span><span class="identifier">K</span><span class="paren">)</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,      <span class="comment"># large groups (char)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">18</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id3</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">sprintf</span><span class="paren">(</span><span class="string">"id%010d"</span>,<span class="number">1</span><span class="operator">:</span><span class="paren">(</span><span class="identifier">N</span><span class="operator">/</span><span class="identifier">K</span><span class="paren">)</span><span class="paren">)</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>, <span class="comment"># small groups (char)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">19</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id4</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">K</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,                          <span class="comment"># large groups (int)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">20</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id5</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">K</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,                          <span class="comment"># large groups (int)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">21</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">id6</span> <span class="operator">=</span> <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">N</span><span class="operator">/</span><span class="identifier">K</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,                        <span class="comment"># small groups (int)</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">22</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">v1</span> <span class="operator">=</span>  <span class="identifier">sample</span><span class="paren">(</span><span class="number">5</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,                          <span class="comment"># int in range [1,5]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">23</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">v2</span> <span class="operator">=</span>  <span class="identifier">sample</span><span class="paren">(</span><span class="number">5</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span>,                          <span class="comment"># int in range [1,5]</span></pre>
                    </td>
                  </tr>
                  <tr class="covered">
                    <td class="num">24</td>
                    <td class="coverage">16<em>x</em></td>
                    <td class="col-sm-12">
                      <pre class="language-r">    <span class="identifier">v3</span> <span class="operator">=</span>  <span class="identifier">sample</span><span class="paren">(</span><span class="identifier">round</span><span class="paren">(</span><span class="identifier">runif</span><span class="paren">(</span><span class="number">100</span>,<span class="identifier">max</span><span class="operator">=</span><span class="number">100</span><span class="paren">)</span>,<span class="number">4</span><span class="paren">)</span>, <span class="identifier">N</span>, <span class="literal">TRUE</span><span class="paren">)</span> <span class="comment"># numeric e.g. 23.5749</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">25</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r">  <span class="paren">)</span></pre>
                    </td>
                  </tr>
                  <tr class="never">
                    <td class="num">26</td>
                    <td class="coverage"></td>
                    <td class="col-sm-12">
                      <pre class="language-r"><span class="paren">}</span></pre>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <script>$('div#files pre').each(function(i, block) {
    hljs.highlightBlock(block);
});</script>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


</body></html>